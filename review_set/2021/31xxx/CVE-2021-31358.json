{
    "containers": {
        "cna": {
            "affected": [
                {
                    "product": "Junos OS Evolved",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R2-S2-EVO",
                            "status": "affected",
                            "version": "unspecified",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "21.1R2-EVO",
                            "status": "affected",
                            "version": "21.1",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "21.2R1-S1-EVO, 21.2R2-EVO",
                            "status": "affected",
                            "version": "21.2",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "datePublic": "2021-10-13T00:00:00",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A command injection vulnerability in sftp command processing on Juniper Networks Junos OS Evolved allows an attacker with authenticated CLI access to be able to bypass configured access protections to execute arbitrary shell commands within the context of the current user. The vulnerability allows an attacker to bypass command authorization restrictions assigned to their specific user account and execute commands that are available to the privilege level for which the user is assigned. For example, a user that is in the super-user login class, but restricted to executing specific CLI commands could exploit the vulnerability to execute any other command available to an unrestricted admin user. This vulnerability does not increase the privilege level of the user, but rather bypasses any CLI command restrictions by allowing full access to the shell. This issue affects Juniper Networks Junos OS Evolved: All versions prior to 20.4R2-S2-EVO; 21.1 versions prior to 21.1R2-EVO; 21.2 versions prior to 21.2R1-S1-EVO, 21.2R2-EVO."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-77",
                            "description": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "dateUpdated": "2021-10-19T18:16:42",
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper"
            },
            "references": [
                {
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://kb.juniper.net/JSA11221"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue: Junos OS Evolved 20.4R2-S2-EVO, 21.1R2-EVO, 21.2R1-S1-EVO, 21.2R2-EVO, 21.3R1-EVO, and all subsequent releases.\n"
                }
            ],
            "source": {
                "advisory": "JSA11221",
                "defect": [
                    "1596123"
                ],
                "discovery": "INTERNAL"
            },
            "title": "Junos OS Evolved: shell-injection vulnerabilities in evo_sftp UI wrapper script",
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Use access lists or firewall filters to limit access to the device via CLI only from trusted hosts and from trusted administrators.\n\nLimit access to the 'file copy' command to authorized administrators."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "x_legacyV4Record": {
                "CVE_data_meta": {
                    "ASSIGNER": "sirt@juniper.net",
                    "DATE_PUBLIC": "2021-10-13T16:00:00.000Z",
                    "ID": "CVE-2021-31358",
                    "STATE": "PUBLIC",
                    "TITLE": "Junos OS Evolved: shell-injection vulnerabilities in evo_sftp UI wrapper script"
                },
                "affects": {
                    "vendor": {
                        "vendor_data": [
                            {
                                "product": {
                                    "product_data": [
                                        {
                                            "product_name": "Junos OS Evolved",
                                            "version": {
                                                "version_data": [
                                                    {
                                                        "version_affected": "<",
                                                        "version_value": "20.4R2-S2-EVO"
                                                    },
                                                    {
                                                        "version_affected": "<",
                                                        "version_name": "21.1",
                                                        "version_value": "21.1R2-EVO"
                                                    },
                                                    {
                                                        "version_affected": "<",
                                                        "version_name": "21.2",
                                                        "version_value": "21.2R1-S1-EVO, 21.2R2-EVO"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                "vendor_name": "Juniper Networks"
                            }
                        ]
                    }
                },
                "data_format": "MITRE",
                "data_type": "CVE",
                "data_version": "4.0",
                "description": {
                    "description_data": [
                        {
                            "lang": "eng",
                            "value": "A command injection vulnerability in sftp command processing on Juniper Networks Junos OS Evolved allows an attacker with authenticated CLI access to be able to bypass configured access protections to execute arbitrary shell commands within the context of the current user. The vulnerability allows an attacker to bypass command authorization restrictions assigned to their specific user account and execute commands that are available to the privilege level for which the user is assigned. For example, a user that is in the super-user login class, but restricted to executing specific CLI commands could exploit the vulnerability to execute any other command available to an unrestricted admin user. This vulnerability does not increase the privilege level of the user, but rather bypasses any CLI command restrictions by allowing full access to the shell. This issue affects Juniper Networks Junos OS Evolved: All versions prior to 20.4R2-S2-EVO; 21.1 versions prior to 21.1R2-EVO; 21.2 versions prior to 21.2R1-S1-EVO, 21.2R2-EVO."
                        }
                    ]
                },
                "exploit": [
                    {
                        "lang": "en",
                        "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                    }
                ],
                "generator": {
                    "engine": "Vulnogram 0.0.9"
                },
                "impact": {
                    "cvss": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    }
                },
                "problemtype": {
                    "problemtype_data": [
                        {
                            "description": [
                                {
                                    "lang": "eng",
                                    "value": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')"
                                }
                            ]
                        }
                    ]
                },
                "references": {
                    "reference_data": [
                        {
                            "name": "https://kb.juniper.net/JSA11221",
                            "refsource": "CONFIRM",
                            "url": "https://kb.juniper.net/JSA11221"
                        }
                    ]
                },
                "solution": [
                    {
                        "lang": "en",
                        "value": "The following software releases have been updated to resolve this specific issue: Junos OS Evolved 20.4R2-S2-EVO, 21.1R2-EVO, 21.2R1-S1-EVO, 21.2R2-EVO, 21.3R1-EVO, and all subsequent releases.\n"
                    }
                ],
                "source": {
                    "advisory": "JSA11221",
                    "defect": [
                        "1596123"
                    ],
                    "discovery": "INTERNAL"
                },
                "work_around": [
                    {
                        "lang": "en",
                        "value": "Use access lists or firewall filters to limit access to the device via CLI only from trusted hosts and from trusted administrators.\n\nLimit access to the 'file copy' command to authorized administrators."
                    }
                ]
            }
        }
    },
    "cveMetadata": {
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "cveId": "CVE-2021-31358",
        "datePublished": "2021-10-13T00:00:00",
        "dateReserved": "2021-04-15T00:00:00",
        "dateUpdated": "2021-10-19T18:16:42",
        "state": "PUBLISHED"
    },
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0"
}