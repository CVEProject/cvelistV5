{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2026-1721",
        "assignerOrgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
        "state": "PUBLISHED",
        "assignerShortName": "cloudflare",
        "dateReserved": "2026-01-30T20:12:22.668Z",
        "datePublished": "2026-02-13T01:46:48.674Z",
        "dateUpdated": "2026-02-13T01:48:24.571Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/cloudflare",
                    "defaultStatus": "unaffected",
                    "packageName": "agents",
                    "repo": "https://github.com/cloudflare/agents",
                    "versions": [
                        {
                            "lessThan": "0.3.10",
                            "status": "affected",
                            "version": "0",
                            "versionType": "git"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "Nishant Kumawat"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p><span style=\"background-color: transparent;\"><b>Summary</b></span></p><p><span style=\"background-color: transparent;\">A Reflected Cross-Site Scripting (XSS) vulnerability was discovered in the AI Playground's OAuth callback handler. The `error_description` query parameter was directly interpolated into an HTML script tag without proper escaping, allowing attackers to execute arbitrary JavaScript in the context of the victim's session.</span></p><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\"><b>Root cause</b></span></p><p><span style=\"background-color: transparent;\">The OAuth callback handler in `site/ai-playground/src/server.ts` directly interpolated the `authError` value, sourced from the `error_description` query parameter,  into an inline `&lt;script&gt;` tag.</span></p><b><br></b><p><span style=\"background-color: transparent;\"><b>Impact</b></span></p><p><span style=\"background-color: transparent;\">An attacker could craft a malicious link that, when clicked by a victim, would:</span></p><ol><li><p><span style=\"background-color: transparent;\">Steal user chat message history - Access all LLM interactions stored in the user's session.</span></p></li><li><p><span style=\"background-color: transparent;\">Access connected MCP Servers - Interact with any MCP servers connected to the victim's session (public or authenticated/private), potentially allowing the attacker to perform actions on the victim's behalf</span></p></li></ol><div><b><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\">Mitigation:</span></p></b><ul><li><p><span style=\"background-color: transparent;\">PR:&nbsp;</span><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/agents/pull/841\"><span style=\"background-color: transparent;\">https://github.com/cloudflare/agents/pull/841</span></a></p></li></ul><ul><li><p><span style=\"background-color: transparent;\">Agents-sdk users should upgrade to&nbsp;</span><span style=\"background-color: transparent;\">agents@0.3.10</span></p></li></ul><ul><li><p><span style=\"background-color: transparent;\">Developers using configureOAuthCallback with custom error handling in their own applications should ensure all user-controlled input is escaped before interpolation.</span></p></li></ul></div><br>"
                        }
                    ],
                    "value": "Summary\n\nA Reflected Cross-Site Scripting (XSS) vulnerability was discovered in the AI Playground's OAuth callback handler. The `error_description` query parameter was directly interpolated into an HTML script tag without proper escaping, allowing attackers to execute arbitrary JavaScript in the context of the victim's session.\n\n\n\n\nRoot cause\n\nThe OAuth callback handler in `site/ai-playground/src/server.ts` directly interpolated the `authError` value, sourced from the `error_description` query parameter,  into an inline `<script>` tag.\n\n\nImpact\n\nAn attacker could craft a malicious link that, when clicked by a victim, would:\n\n  *  Steal user chat message history - Access all LLM interactions stored in the user's session.\n\n\n  *  Access connected MCP Servers - Interact with any MCP servers connected to the victim's session (public or authenticated/private), potentially allowing the attacker to perform actions on the victim's behalf\n\n\n\n\n\nMitigation:\n\n  *  PR:  https://github.com/cloudflare/agents/pull/841 https://github.com/cloudflare/agents/pull/841 \n\n\n\n\n  *  Agents-sdk users should upgrade to agents@0.3.10\n\n\n\n\n  *  Developers using configureOAuthCallback with custom error handling in their own applications should ensure all user-controlled input is escaped before interpolation."
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "NETWORK",
                        "baseScore": 6.2,
                        "baseSeverity": "MEDIUM",
                        "exploitMaturity": "NOT_DEFINED",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "NONE",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "LOW",
                        "userInteraction": "ACTIVE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:H/SI:L/SA:N",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "NONE",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "NONE",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
                "shortName": "cloudflare",
                "dateUpdated": "2026-02-13T01:48:24.571Z"
            },
            "references": [
                {
                    "url": "https://github.com/cloudflare/agents/pull/841"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<ul><li><p><span style=\"background-color: transparent;\">PR: </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/agents/pull/841\"><span style=\"background-color: transparent;\">https://github.com/cloudflare/agents/pull/841</span></a></p></li></ul><ul><li><p><span style=\"background-color: transparent;\">Agents-sdk users should upgrade to `</span><code><span style=\"background-color: transparent;\">agents@0.3.10`</span></code></p></li><li><p><span style=\"background-color: transparent;\">Developers using `</span>configureOAuthCallback`<span style=\"background-color: transparent;\"> with custom error handling in their own applications should ensure all user-controlled input is escaped before interpolation.</span></p></li></ul>"
                        }
                    ],
                    "value": "*  PR:  https://github.com/cloudflare/agents/pull/841 https://github.com/cloudflare/agents/pull/841 \n\n\n\n\n  *  Agents-sdk users should upgrade to `agents@0.3.10`\n\n\n  *  Developers using `configureOAuthCallback` with custom error handling in their own applications should ensure all user-controlled input is escaped before interpolation."
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Reflected Cross-Site Scripting (XSS) vulnerability in AI Playground site",
            "x_generator": {
                "engine": "Vulnogram 0.5.0"
            }
        }
    }
}