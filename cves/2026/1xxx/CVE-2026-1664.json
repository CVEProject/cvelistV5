{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2026-1664",
        "assignerOrgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
        "state": "PUBLISHED",
        "assignerShortName": "cloudflare",
        "dateReserved": "2026-01-29T21:09:21.411Z",
        "datePublished": "2026-02-03T11:39:18.810Z",
        "dateUpdated": "2026-02-03T14:46:36.842Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/cloudflare/agents",
                    "defaultStatus": "unaffected",
                    "packageName": "agents",
                    "repo": "https://github.com/cloudflare/agents",
                    "versions": [
                        {
                            "lessThanOrEqual": "0.3.6",
                            "status": "affected",
                            "version": "0.0.104",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "asukalangley"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<b><p><span style=\"background-color: transparent;\">Summary</span></p></b><p>An Insecure Direct Object Reference has been found to exist in `createHeaderBasedEmailResolver()` function within the Cloudflare Agents SDK. The issue occurs because the `Message-ID` and `References` headers are parsed to derive the target agentName and agentId without proper validation or origin checks, allowing an external attacker with control of these headers to route inbound mail to arbitrary Durable Object instances and namespaces .</p><b><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\">Root cause</span></p></b><p><span style=\"background-color: transparent;\">The `</span><span style=\"background-color: transparent;\">createHeaderBasedEmailResolver()`</span><span style=\"background-color: transparent;\"> function lacks cryptographic verification or origin validation for the headers used in the routing logic, effectively allowing external input to dictate internal object routing.</span></p><b><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\">Impact</span></p></b><p><span style=\"background-color: transparent;\">Insecure Direct Object Reference (IDOR) in email routing lets an attacker steer inbound mail to arbitrary Agent instances via spoofed Message-ID.</span><br></p><p><span style=\"background-color: transparent;\"><br></span></p><p><span style=\"background-color: transparent;\"><b>Mitigation:</b></span></p><ul><li><span style=\"background-color: transparent;\">PR: </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/agents/pull/811\"><span style=\"background-color: transparent;\">https://github.com/cloudflare/agents/pull/811</span></a></li><li>This <a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/agents/blob/main/docs/email.md\"><span style=\"background-color: transparent;\">documentation</span></a><span style=\"background-color: transparent;\">&nbsp;[<a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/agents/blob/main/docs/email.md\">https://github.com/cloudflare/agents/blob/main/docs/email.md</a>] provides the necessary architectural context for coding agents to mitigate the issue by refactoring the resolver to enforce strict identity boundaries.</span></li><li>Agents-sdk users should  upgrade to <span style=\"background-color: transparent;\">agents@0.3.7</span></li></ul><p></p><b></b>"
                        }
                    ],
                    "value": "Summary\n\nAn Insecure Direct Object Reference has been found to exist in `createHeaderBasedEmailResolver()` function within the Cloudflare Agents SDK. The issue occurs because the `Message-ID` and `References` headers are parsed to derive the target agentName and agentId without proper validation or origin checks, allowing an external attacker with control of these headers to route inbound mail to arbitrary Durable Object instances and namespaces .\n\n\n\n\nRoot cause\n\nThe `createHeaderBasedEmailResolver()` function lacks cryptographic verification or origin validation for the headers used in the routing logic, effectively allowing external input to dictate internal object routing.\n\n\n\n\nImpact\n\nInsecure Direct Object Reference (IDOR) in email routing lets an attacker steer inbound mail to arbitrary Agent instances via spoofed Message-ID.\n\n\n\n\n\nMitigation:\n\n  *  PR:  https://github.com/cloudflare/agents/blob/main/docs/email.md ] provides the necessary architectural context for coding agents to mitigate the issue by refactoring the resolver to enforce strict identity boundaries.\n  *  Agents-sdk users should  upgrade to agents@0.3.7"
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "NETWORK",
                        "baseScore": 6.9,
                        "baseSeverity": "MEDIUM",
                        "exploitMaturity": "NOT_DEFINED",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "NONE",
                        "subConfidentialityImpact": "LOW",
                        "subIntegrityImpact": "LOW",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "NONE",
                        "vulnConfidentialityImpact": "LOW",
                        "vulnIntegrityImpact": "LOW",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-639",
                            "description": "CWE-639 Authorization Bypass Through User-Controlled Key",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
                "shortName": "cloudflare",
                "dateUpdated": "2026-02-03T11:45:10.068Z"
            },
            "references": [
                {
                    "url": "https://github.com/cloudflare/agents"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Insecure Direct Object Reference (IDOR) via Header-Based Email Routing",
            "x_generator": {
                "engine": "Vulnogram 0.5.0"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2026-02-03T14:38:24.747542Z",
                                "id": "CVE-2026-1664",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "yes"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2026-02-03T14:46:36.842Z"
                }
            }
        ]
    }
}