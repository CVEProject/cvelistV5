{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2021-46968",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-02-27T18:42:55.943Z",
        "datePublished": "2024-02-27T18:47:04.856Z",
        "dateUpdated": "2024-05-28T19:35:06.352Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-05-28T19:35:06.352Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ns390/zcrypt: fix zcard and zqueue hot-unplug memleak\n\nTests with kvm and a kmemdebug kernel showed, that on hot unplug the\nzcard and zqueue structs for the unplugged card or queue are not\nproperly freed because of a mismatch with get/put for the embedded\nkref counter.\n\nThis fix now adjusts the handling of the kref counters. With init the\nkref counter starts with 1. This initial value needs to drop to zero\nwith the unregister of the card or queue to trigger the release and\nfree the object."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/s390/crypto/zcrypt_card.c",
                        "drivers/s390/crypto/zcrypt_queue.c"
                    ],
                    "versions": [
                        {
                            "version": "29c2680fd2bf",
                            "lessThan": "026499a9c2e0",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "29c2680fd2bf",
                            "lessThan": "055a063a18bc",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "29c2680fd2bf",
                            "lessThan": "971dc8706cee",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "29c2680fd2bf",
                            "lessThan": "70fac8088cfa",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/s390/crypto/zcrypt_card.c",
                        "drivers/s390/crypto/zcrypt_queue.c"
                    ],
                    "versions": [
                        {
                            "version": "5.10",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "5.10",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.10.36",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.11.20",
                            "lessThanOrEqual": "5.11.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.12.3",
                            "lessThanOrEqual": "5.12.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.13",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/026499a9c2e002e621ad568d1378324ae97e5524"
                },
                {
                    "url": "https://git.kernel.org/stable/c/055a063a18bcd19b93709e3eac8078d6b2f04599"
                },
                {
                    "url": "https://git.kernel.org/stable/c/971dc8706cee47393d393905d294ea47e39503d3"
                },
                {
                    "url": "https://git.kernel.org/stable/c/70fac8088cfad9f3b379c9082832b4d7532c16c2"
                }
            ],
            "title": "s390/zcrypt: fix zcard and zqueue hot-unplug memleak",
            "x_generator": {
                "engine": "bippy-a5840b7849dd"
            }
        }
    }
}