{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2021-47223",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-04-10T18:59:19.529Z",
        "datePublished": "2024-05-21T14:19:28.882Z",
        "dateUpdated": "2024-05-28T19:40:20.777Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-05-28T19:40:20.777Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: bridge: fix vlan tunnel dst null pointer dereference\n\nThis patch fixes a tunnel_dst null pointer dereference due to lockless\naccess in the tunnel egress path. When deleting a vlan tunnel the\ntunnel_dst pointer is set to NULL without waiting a grace period (i.e.\nwhile it's still usable) and packets egressing are dereferencing it\nwithout checking. Use READ/WRITE_ONCE to annotate the lockless use of\ntunnel_id, use RCU for accessing tunnel_dst and make sure it is read\nonly once and checked in the egress path. The dst is already properly RCU\nprotected so we don't need to do anything fancy than to make sure\ntunnel_id and tunnel_dst are read only once and checked in the egress path."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/bridge/br_private.h",
                        "net/bridge/br_vlan_tunnel.c"
                    ],
                    "versions": [
                        {
                            "version": "11538d039ac6",
                            "lessThan": "ad7feefe7164",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "11538d039ac6",
                            "lessThan": "24a6e55f17aa",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "11538d039ac6",
                            "lessThan": "a2241e62f6b4",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "11538d039ac6",
                            "lessThan": "fe0448a3fad3",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "11538d039ac6",
                            "lessThan": "abb02e05cb1c",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "11538d039ac6",
                            "lessThan": "58e2071742e3",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/bridge/br_private.h",
                        "net/bridge/br_vlan_tunnel.c"
                    ],
                    "versions": [
                        {
                            "version": "4.11",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.11",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.14.238",
                            "lessThanOrEqual": "4.14.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.19.196",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.4.128",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.10.46",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.12.13",
                            "lessThanOrEqual": "5.12.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.13",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/ad7feefe7164892db424c45687472db803d87f79"
                },
                {
                    "url": "https://git.kernel.org/stable/c/24a6e55f17aa123bc1fc54b7d3c410b41bc16530"
                },
                {
                    "url": "https://git.kernel.org/stable/c/a2241e62f6b4a774d8a92048fdf59c45f6c2fe5c"
                },
                {
                    "url": "https://git.kernel.org/stable/c/fe0448a3fad365a747283a00a1d1ad5e8d6675b7"
                },
                {
                    "url": "https://git.kernel.org/stable/c/abb02e05cb1c0a30dd873a29f33bc092067dc35d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/58e2071742e38f29f051b709a5cca014ba51166f"
                }
            ],
            "title": "net: bridge: fix vlan tunnel dst null pointer dereference",
            "x_generator": {
                "engine": "bippy-a5840b7849dd"
            }
        }
    }
}