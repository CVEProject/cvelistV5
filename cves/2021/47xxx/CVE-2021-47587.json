{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2021-47587",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-05-24T15:11:00.732Z",
        "datePublished": "2024-06-19T14:53:52.133Z",
        "dateUpdated": "2024-06-19T14:53:52.133Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-06-19T14:53:52.133Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: systemport: Add global locking for descriptor lifecycle\n\nThe descriptor list is a shared resource across all of the transmit queues, and\nthe locking mechanism used today only protects concurrency across a given\ntransmit queue between the transmit and reclaiming. This creates an opportunity\nfor the SYSTEMPORT hardware to work on corrupted descriptors if we have\nmultiple producers at once which is the case when using multiple transmit\nqueues.\n\nThis was particularly noticeable when using multiple flows/transmit queues and\nit showed up in interesting ways in that UDP packets would get a correct UDP\nheader checksum being calculated over an incorrect packet length. Similarly TCP\npackets would get an equally correct checksum computed by the hardware over an\nincorrect packet length.\n\nThe SYSTEMPORT hardware maintains an internal descriptor list that it re-arranges\nwhen the driver produces a new descriptor anytime it writes to the\nWRITE_PORT_{HI,LO} registers, there is however some delay in the hardware to\nre-organize its descriptors and it is possible that concurrent TX queues\neventually break this internal allocation scheme to the point where the\nlength/status part of the descriptor gets used for an incorrect data buffer.\n\nThe fix is to impose a global serialization for all TX queues in the short\nsection where we are writing to the WRITE_PORT_{HI,LO} registers which solves\nthe corruption even with multiple concurrent TX queues being used."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/net/ethernet/broadcom/bcmsysport.c",
                        "drivers/net/ethernet/broadcom/bcmsysport.h"
                    ],
                    "versions": [
                        {
                            "version": "80105befdb4b",
                            "lessThan": "8ed2f5d08d6e",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "de57f62f7645",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "f3fde37d3f0d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "595a684fa6f2",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "c675256a7f13",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "6e1011cd183f",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "eb4687c74429",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "80105befdb4b",
                            "lessThan": "8b8e6e782456",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/net/ethernet/broadcom/bcmsysport.c",
                        "drivers/net/ethernet/broadcom/bcmsysport.h"
                    ],
                    "versions": [
                        {
                            "version": "3.16",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "3.16",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.4.296",
                            "lessThanOrEqual": "4.4.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.9.294",
                            "lessThanOrEqual": "4.9.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.14.259",
                            "lessThanOrEqual": "4.14.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.19.222",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.4.168",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.10.88",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.15.11",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.16",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/8ed2f5d08d6e59f8c78b2869bfb95d0be32c094c"
                },
                {
                    "url": "https://git.kernel.org/stable/c/de57f62f76450b934de8203711bdc4f7953c3421"
                },
                {
                    "url": "https://git.kernel.org/stable/c/f3fde37d3f0d429f0fcce214cb52588a9e21260e"
                },
                {
                    "url": "https://git.kernel.org/stable/c/595a684fa6f23b21958379a18cfa83862c73c2e1"
                },
                {
                    "url": "https://git.kernel.org/stable/c/c675256a7f131f5ba3f331efb715e8f31ea0e392"
                },
                {
                    "url": "https://git.kernel.org/stable/c/6e1011cd183faae8daff275c72444edcdfe0d473"
                },
                {
                    "url": "https://git.kernel.org/stable/c/eb4687c7442942e115420a30185f8d83faf37696"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8b8e6e782456f1ce02a7ae914bbd5b1053f0b034"
                }
            ],
            "title": "net: systemport: Add global locking for descriptor lifecycle",
            "x_generator": {
                "engine": "bippy-a5840b7849dd"
            }
        }
    }
}