{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2021-47653",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-02-26T01:48:21.520Z",
        "datePublished": "2025-02-26T01:54:18.596Z",
        "dateUpdated": "2025-02-26T01:54:18.596Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-02-26T01:54:18.596Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: davinci: vpif: fix use-after-free on driver unbind\n\nThe driver allocates and registers two platform device structures during\nprobe, but the devices were never deregistered on driver unbind.\n\nThis results in a use-after-free on driver unbind as the device\nstructures were allocated using devres and would be freed by driver\ncore when remove() returns.\n\nFix this by adding the missing deregistration calls to the remove()\ncallback and failing probe on registration errors.\n\nNote that the platform device structures must be freed using a proper\nrelease callback to avoid leaking associated resources like device\nnames."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/media/platform/davinci/vpif.c"
                    ],
                    "versions": [
                        {
                            "version": "479f7a1181058689435baddc16a6a42e1a8ff0e8",
                            "lessThan": "6512c3c39cb6b573b791ce45365818a38b76afbe",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "479f7a1181058689435baddc16a6a42e1a8ff0e8",
                            "lessThan": "b5a3bb7f6f164eb6ee74ef4898dcd019b2063448",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "479f7a1181058689435baddc16a6a42e1a8ff0e8",
                            "lessThan": "9ffc602e14d7b9f7e7cb2f67e18dfef9ef8af676",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "479f7a1181058689435baddc16a6a42e1a8ff0e8",
                            "lessThan": "43acb728bbc40169d2e2425e84a80068270974be",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/media/platform/davinci/vpif.c"
                    ],
                    "versions": [
                        {
                            "version": "4.13",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.13",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.54",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.16.19",
                            "lessThanOrEqual": "5.16.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.17.2",
                            "lessThanOrEqual": "5.17.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.18",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/6512c3c39cb6b573b791ce45365818a38b76afbe"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b5a3bb7f6f164eb6ee74ef4898dcd019b2063448"
                },
                {
                    "url": "https://git.kernel.org/stable/c/9ffc602e14d7b9f7e7cb2f67e18dfef9ef8af676"
                },
                {
                    "url": "https://git.kernel.org/stable/c/43acb728bbc40169d2e2425e84a80068270974be"
                }
            ],
            "title": "media: davinci: vpif: fix use-after-free on driver unbind",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}