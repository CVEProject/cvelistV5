{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2022-50616",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-12-08T01:14:55.189Z",
        "datePublished": "2025-12-08T01:16:29.407Z",
        "dateUpdated": "2025-12-23T13:30:18.720Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-12-23T13:30:18.720Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nregulator: core: Use different devices for resource allocation and DT lookup\n\nFollowing by the below discussion, there's the potential UAF issue\nbetween regulator and mfd.\nhttps://lore.kernel.org/all/20221128143601.1698148-1-yangyingliang@huawei.com/\n\nFrom the analysis of Yingliang\n\nCPU A\t\t\t\t|CPU B\nmt6370_probe()\t\t\t|\n  devm_mfd_add_devices()\t|\n\t\t\t\t|mt6370_regulator_probe()\n\t\t\t\t|  regulator_register()\n\t\t\t\t|    //allocate init_data and add it to devres\n\t\t\t\t|    regulator_of_get_init_data()\ni2c_unregister_device()\t\t|\n  device_del()\t\t\t|\n    devres_release_all()\t|\n      // init_data is freed\t|\n      release_nodes()\t\t|\n\t\t\t\t|  // using init_data causes UAF\n\t\t\t\t|  regulator_register()\n\nIt's common to use mfd core to create child device for the regulator.\nIn order to do the DT lookup for init data, the child that registered\nthe regulator would pass its parent as the parameter. And this causes\ninit data resource allocated to its parent, not itself. The issue happen\nwhen parent device is going to release and regulator core is still doing\nsome operation of init data constraint for the regulator of child device.\n\nTo fix it, this patch expand 'regulator_register' API to use the\ndifferent devices for init data allocation and DT lookup."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/platform/x86/intel/int3472/clk_and_regulator.c",
                        "drivers/regulator/core.c",
                        "drivers/regulator/devres.c",
                        "drivers/regulator/of_regulator.c",
                        "drivers/regulator/stm32-vrefbuf.c",
                        "include/linux/regulator/driver.h"
                    ],
                    "versions": [
                        {
                            "version": "a0c7b164ad115ec0556dc0904ee2218cbc5cedfa",
                            "lessThan": "cb29811d989bcb7ea81ca111c4b13878b344e086",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a0c7b164ad115ec0556dc0904ee2218cbc5cedfa",
                            "lessThan": "b0f25ca1ff9be7abd1679ae7e59a8f25dbffe67a",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a0c7b164ad115ec0556dc0904ee2218cbc5cedfa",
                            "lessThan": "8f3cbcd6b440032ebc7f7d48a1689dcc70a4eb98",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/platform/x86/intel/int3472/clk_and_regulator.c",
                        "drivers/regulator/core.c",
                        "drivers/regulator/devres.c",
                        "drivers/regulator/of_regulator.c",
                        "drivers/regulator/stm32-vrefbuf.c",
                        "include/linux/regulator/driver.h"
                    ],
                    "versions": [
                        {
                            "version": "3.18",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "3.18",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.0.16",
                            "lessThanOrEqual": "6.0.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.2",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.2",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "cpeApplicability": [
                {
                    "nodes": [
                        {
                            "operator": "OR",
                            "negate": false,
                            "cpeMatch": [
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "3.18",
                                    "versionEndExcluding": "6.0.16"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "3.18",
                                    "versionEndExcluding": "6.1.2"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "3.18",
                                    "versionEndExcluding": "6.2"
                                }
                            ]
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/cb29811d989bcb7ea81ca111c4b13878b344e086"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b0f25ca1ff9be7abd1679ae7e59a8f25dbffe67a"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8f3cbcd6b440032ebc7f7d48a1689dcc70a4eb98"
                }
            ],
            "title": "regulator: core: Use different devices for resource allocation and DT lookup",
            "x_generator": {
                "engine": "bippy-1.2.0"
            }
        }
    }
}