{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2022-50838",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-12-30T12:06:07.133Z",
        "datePublished": "2025-12-30T12:10:57.721Z",
        "dateUpdated": "2025-12-30T12:10:57.721Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-12-30T12:10:57.721Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: stream: purge sk_error_queue in sk_stream_kill_queues()\n\nChangheon Lee reported TCP socket leaks, with a nice repro.\n\nIt seems we leak TCP sockets with the following sequence:\n\n1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.\n\n   Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().\n   __skb_tstamp_tx() is using skb_clone(), unless\n   SOF_TIMESTAMPING_OPT_TSONLY was also requested.\n\n2) If the application is also using MSG_ZEROCOPY, then we put in the\n   error queue cloned skbs that had a struct ubuf_info attached to them.\n\n   Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()\n   does a sock_hold().\n\n   As long as the cloned skbs are still in sk_error_queue,\n   socket refcount is kept elevated.\n\n3) Application closes the socket, while error queue is not empty.\n\nSince tcp_close() no longer purges the socket error queue,\nwe might end up with a TCP socket with at least one skb in\nerror queue keeping the socket alive forever.\n\nThis bug can be (ab)used to consume all kernel memory\nand freeze the host.\n\nWe need to purge the error queue, with proper synchronization\nagainst concurrent writers."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/core/stream.c"
                    ],
                    "versions": [
                        {
                            "version": "7737b104c211fa843de268b897d601e070292a72",
                            "lessThan": "c8c1eec578a9ae2dc8f14a1846942a0b7bf29d1d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "89be5c357de34718eaaaefed80737f432c5ab86f",
                            "lessThan": "bab542cf56fc174c8447c00b73be99ffd66d2d39",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "8b8b3d738e450d2c2ccdc75f0ab5a951746c2a96",
                            "lessThan": "6f00bd0402a1e3d2d556afba57c045bd7931e4d3",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "b631c603b5fb98d2bd709c35d384901965a3dd51",
                            "lessThan": "4f1d37ff4226eb99d6b69e9f4518e279e1a851bf",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "daf15fa1fd997749e881aedd9f03f73a11240e82",
                            "lessThan": "9062493811676ee0efe6c74d98f00ca38c4e17d4",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "3988164fe9ddf98ebf5b5cdede91ac38c5f08a7e",
                            "lessThan": "9da204cd67c4fe97e8aa465d10d5c2e7076f7f42",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "24bcbe1cc69fa52dc4f7b5b2456678ed464724d8",
                            "lessThan": "8c330c36b3970d0917f48827fa6c7a9c75aa4602",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "24bcbe1cc69fa52dc4f7b5b2456678ed464724d8",
                            "lessThan": "b458d349f8753f666233828ebd30df6f100cf7d5",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "24bcbe1cc69fa52dc4f7b5b2456678ed464724d8",
                            "lessThan": "e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "6ba975e14f5ebb87143d737c493adf4031409a68",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4437f3ead9e85c35fe0e3adfb98c0b97eaa267eb",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/core/stream.c"
                    ],
                    "versions": [
                        {
                            "version": "5.16",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "5.16",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.9.337",
                            "lessThanOrEqual": "4.9.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.14.303",
                            "lessThanOrEqual": "4.14.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.19.270",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.229",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.163",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.86",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.0.16",
                            "lessThanOrEqual": "6.0.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.2",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.2",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "cpeApplicability": [
                {
                    "nodes": [
                        {
                            "operator": "OR",
                            "negate": false,
                            "cpeMatch": [
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.9.291",
                                    "versionEndExcluding": "4.9.337"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.14.256",
                                    "versionEndExcluding": "4.14.303"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.19.218",
                                    "versionEndExcluding": "4.19.270"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.4.160",
                                    "versionEndExcluding": "5.4.229"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.10.80",
                                    "versionEndExcluding": "5.10.163"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.15.3",
                                    "versionEndExcluding": "5.15.86"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.16",
                                    "versionEndExcluding": "6.0.16"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.16",
                                    "versionEndExcluding": "6.1.2"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.16",
                                    "versionEndExcluding": "6.2"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.4.293"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "5.14.19"
                                }
                            ]
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/c8c1eec578a9ae2dc8f14a1846942a0b7bf29d1d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/bab542cf56fc174c8447c00b73be99ffd66d2d39"
                },
                {
                    "url": "https://git.kernel.org/stable/c/6f00bd0402a1e3d2d556afba57c045bd7931e4d3"
                },
                {
                    "url": "https://git.kernel.org/stable/c/4f1d37ff4226eb99d6b69e9f4518e279e1a851bf"
                },
                {
                    "url": "https://git.kernel.org/stable/c/9062493811676ee0efe6c74d98f00ca38c4e17d4"
                },
                {
                    "url": "https://git.kernel.org/stable/c/9da204cd67c4fe97e8aa465d10d5c2e7076f7f42"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8c330c36b3970d0917f48827fa6c7a9c75aa4602"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b458d349f8753f666233828ebd30df6f100cf7d5"
                },
                {
                    "url": "https://git.kernel.org/stable/c/e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3"
                }
            ],
            "title": "net: stream: purge sk_error_queue in sk_stream_kill_queues()",
            "x_generator": {
                "engine": "bippy-1.2.0"
            }
        }
    }
}