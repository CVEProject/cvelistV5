{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-49203",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-02-26T01:49:39.291Z",
        "datePublished": "2025-02-26T01:55:44.214Z",
        "dateUpdated": "2025-02-26T01:55:44.214Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-02-26T01:55:44.214Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: Fix double free during GPU reset on DC streams\n\n[Why]\nThe issue only occurs during the GPU reset code path.\n\nWe first backup the current state prior to commiting 0 streams\ninternally from DM to DC. This state backup contains valid link\nencoder assignments.\n\nDC will clear the link encoder assignments as part of current state\n(but not the backup, since it was a copied before the commit) and\nfree the extra stream reference it held.\n\nDC requires that the link encoder assignments remain cleared/invalid\nprior to commiting. Since the backup still has valid assignments we\ncall the interface post reset to clear them. This routine also\nreleases the extra reference that the link encoder interface held -\nresulting in a double free (and eventually a NULL pointer dereference).\n\n[How]\nWe'll have to do a full DC commit anyway after GPU reset because\nthe stream count previously went to 0.\n\nWe don't need to retain the assignment that we had backed up, so\njust copy off of the now clean current state assignment after the\nreset has occcurred with the new link_enc_cfg_copy() interface."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c",
                        "drivers/gpu/drm/amd/display/dc/core/dc_link_enc_cfg.c",
                        "drivers/gpu/drm/amd/display/dc/inc/link_enc_cfg.h"
                    ],
                    "versions": [
                        {
                            "version": "6d63fcc2a334f7bd15e4e9b1db50a19335d2af4f",
                            "lessThan": "bbfcdd6289ba6f00f0cd7d496946dce9f6c600ac",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "6d63fcc2a334f7bd15e4e9b1db50a19335d2af4f",
                            "lessThan": "32685b32d825ca08c5dec826477332df886c4743",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c",
                        "drivers/gpu/drm/amd/display/dc/core/dc_link_enc_cfg.c",
                        "drivers/gpu/drm/amd/display/dc/inc/link_enc_cfg.h"
                    ],
                    "versions": [
                        {
                            "version": "5.17",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "5.17",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.17.2",
                            "lessThanOrEqual": "5.17.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.18",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/bbfcdd6289ba6f00f0cd7d496946dce9f6c600ac"
                },
                {
                    "url": "https://git.kernel.org/stable/c/32685b32d825ca08c5dec826477332df886c4743"
                }
            ],
            "title": "drm/amd/display: Fix double free during GPU reset on DC streams",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}