{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-49149",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-02-26T01:49:39.274Z",
        "datePublished": "2025-02-26T01:55:16.371Z",
        "dateUpdated": "2025-02-26T01:55:16.371Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-02-26T01:55:16.371Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nrxrpc: Fix call timer start racing with call destruction\n\nThe rxrpc_call struct has a timer used to handle various timed events\nrelating to a call.  This timer can get started from the packet input\nroutines that are run in softirq mode with just the RCU read lock held.\nUnfortunately, because only the RCU read lock is held - and neither ref or\nother lock is taken - the call can start getting destroyed at the same time\na packet comes in addressed to that call.  This causes the timer - which\nwas already stopped - to get restarted.  Later, the timer dispatch code may\nthen oops if the timer got deallocated first.\n\nFix this by trying to take a ref on the rxrpc_call struct and, if\nsuccessful, passing that ref along to the timer.  If the timer was already\nrunning, the ref is discarded.\n\nThe timer completion routine can then pass the ref along to the call's work\nitem when it queues it.  If the timer or work item where already\nqueued/running, the extra ref is discarded."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "include/trace/events/rxrpc.h",
                        "net/rxrpc/ar-internal.h",
                        "net/rxrpc/call_event.c",
                        "net/rxrpc/call_object.c"
                    ],
                    "versions": [
                        {
                            "version": "a158bdd3247b9656df36ba133235fff702e9fdc3",
                            "lessThan": "051360e51341cd17738d82c15a8226010c7cb7f6",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a158bdd3247b9656df36ba133235fff702e9fdc3",
                            "lessThan": "8cbf4ae7a2833767d63114573e5f9a45740cc975",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a158bdd3247b9656df36ba133235fff702e9fdc3",
                            "lessThan": "54df5a37f1d951ed27fd47bf9b15a42279582110",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a158bdd3247b9656df36ba133235fff702e9fdc3",
                            "lessThan": "5e3c11144e557a9dbf9a2f6abe444689ef9d8aae",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "a158bdd3247b9656df36ba133235fff702e9fdc3",
                            "lessThan": "4a7f62f91933c8ae5308f9127fd8ea48188b6bc3",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "include/trace/events/rxrpc.h",
                        "net/rxrpc/ar-internal.h",
                        "net/rxrpc/call_event.c",
                        "net/rxrpc/call_object.c"
                    ],
                    "versions": [
                        {
                            "version": "4.15",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.15",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.110",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.33",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.16.19",
                            "lessThanOrEqual": "5.16.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.17.2",
                            "lessThanOrEqual": "5.17.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.18",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/051360e51341cd17738d82c15a8226010c7cb7f6"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8cbf4ae7a2833767d63114573e5f9a45740cc975"
                },
                {
                    "url": "https://git.kernel.org/stable/c/54df5a37f1d951ed27fd47bf9b15a42279582110"
                },
                {
                    "url": "https://git.kernel.org/stable/c/5e3c11144e557a9dbf9a2f6abe444689ef9d8aae"
                },
                {
                    "url": "https://git.kernel.org/stable/c/4a7f62f91933c8ae5308f9127fd8ea48188b6bc3"
                }
            ],
            "title": "rxrpc: Fix call timer start racing with call destruction",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}