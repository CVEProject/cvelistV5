{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-49913",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-05-01T14:05:17.250Z",
        "datePublished": "2025-05-01T14:10:54.899Z",
        "dateUpdated": "2025-05-01T14:10:54.899Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-05-01T14:10:54.899Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix inode list leak during backref walking at find_parent_nodes()\n\nDuring backref walking, at find_parent_nodes(), if we are dealing with a\ndata extent and we get an error while resolving the indirect backrefs, at\nresolve_indirect_refs(), or in the while loop that iterates over the refs\nin the direct refs rbtree, we end up leaking the inode lists attached to\nthe direct refs we have in the direct refs rbtree that were not yet added\nto the refs ulist passed as argument to find_parent_nodes(). Since they\nwere not yet added to the refs ulist and prelim_release() does not free\nthe lists, on error the caller can only free the lists attached to the\nrefs that were added to the refs ulist, all the remaining refs get their\ninode lists never freed, therefore leaking their memory.\n\nFix this by having prelim_release() always free any attached inode list\nto each ref found in the rbtree, and have find_parent_nodes() set the\nref's inode list to NULL once it transfers ownership of the inode list\nto a ref added to the refs ulist passed to find_parent_nodes()."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "fs/btrfs/backref.c"
                    ],
                    "versions": [
                        {
                            "version": "86d5f994425252d8a40e2184c94a2682ae8ecfbf",
                            "lessThan": "6a6731a0df8c47ecc703bd7bb73459df767051e0",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "86d5f994425252d8a40e2184c94a2682ae8ecfbf",
                            "lessThan": "61e06128113711df0534c404fb6bb528eb7d2332",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "86d5f994425252d8a40e2184c94a2682ae8ecfbf",
                            "lessThan": "222a3d533027b9492d5b7f5ecdc01a90f57bb5a9",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "86d5f994425252d8a40e2184c94a2682ae8ecfbf",
                            "lessThan": "83ea8c5b54d452a5769e605e3c5c687e8ca06d89",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "86d5f994425252d8a40e2184c94a2682ae8ecfbf",
                            "lessThan": "92876eec382a0f19f33d09d2c939e9ca49038ae5",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "fs/btrfs/backref.c"
                    ],
                    "versions": [
                        {
                            "version": "4.14",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.14",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.224",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.154",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.78",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.0.8",
                            "lessThanOrEqual": "6.0.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/6a6731a0df8c47ecc703bd7bb73459df767051e0"
                },
                {
                    "url": "https://git.kernel.org/stable/c/61e06128113711df0534c404fb6bb528eb7d2332"
                },
                {
                    "url": "https://git.kernel.org/stable/c/222a3d533027b9492d5b7f5ecdc01a90f57bb5a9"
                },
                {
                    "url": "https://git.kernel.org/stable/c/83ea8c5b54d452a5769e605e3c5c687e8ca06d89"
                },
                {
                    "url": "https://git.kernel.org/stable/c/92876eec382a0f19f33d09d2c939e9ca49038ae5"
                }
            ],
            "title": "btrfs: fix inode list leak during backref walking at find_parent_nodes()",
            "x_generator": {
                "engine": "bippy-1.1.0"
            }
        }
    }
}