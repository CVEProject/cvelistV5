{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-49197",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-02-26T01:49:39.290Z",
        "datePublished": "2025-02-26T01:55:41.112Z",
        "dateUpdated": "2025-02-26T01:55:41.112Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-02-26T01:55:41.112Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_netlink: Fix shift out of bounds in group mask calculation\n\nWhen a netlink message is received, netlink_recvmsg() fills in the address\nof the sender. One of the fields is the 32-bit bitfield nl_groups, which\ncarries the multicast group on which the message was received. The least\nsignificant bit corresponds to group 1, and therefore the highest group\nthat the field can represent is 32. Above that, the UB sanitizer flags the\nout-of-bounds shift attempts.\n\nWhich bits end up being set in such case is implementation defined, but\nit's either going to be a wrong non-zero value, or zero, which is at least\nnot misleading. Make the latter choice deterministic by always setting to 0\nfor higher-numbered multicast groups.\n\nTo get information about membership in groups >= 32, userspace is expected\nto use nl_pktinfo control messages[0], which are enabled by NETLINK_PKTINFO\nsocket option.\n[0] https://lwn.net/Articles/147608/\n\nThe way to trigger this issue is e.g. through monitoring the BRVLAN group:\n\n\t# bridge monitor vlan &\n\t# ip link add name br type bridge\n\nWhich produces the following citation:\n\n\tUBSAN: shift-out-of-bounds in net/netlink/af_netlink.c:162:19\n\tshift exponent 32 is too large for 32-bit type 'int'"
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/netlink/af_netlink.c"
                    ],
                    "versions": [
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "e1c5d46f05aa23d740daae5cd3a6472145afac42",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "ac5883a8890a11c00b32a19949a25d4afeaa2f5a",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "f75f4abeec4c04b600a15b50c89a481f1e7435ee",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "41249fff507387c3323b198d0052faed08b14de4",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "b0898362188e05b2202656058cc32d98fabf3bac",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "7409ff6393a67ff9838d0ae1bd102fb5f020d07a",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "e8aaf3134bc5e943048eefe9f2ddaabf41d92b1a",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "e23e1e981247feb3c7d0236fe58aceb685f234ae",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f7fa9b10edbb9391bdd4ec8e8b3d621d0664b198",
                            "lessThan": "0caf6d9922192dd1afa8dc2131abfb4df1443b9f",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/netlink/af_netlink.c"
                    ],
                    "versions": [
                        {
                            "version": "2.6.14",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "2.6.14",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.9.311",
                            "lessThanOrEqual": "4.9.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.14.276",
                            "lessThanOrEqual": "4.14.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.19.238",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.189",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.110",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.33",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.16.19",
                            "lessThanOrEqual": "5.16.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.17.2",
                            "lessThanOrEqual": "5.17.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.18",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/e1c5d46f05aa23d740daae5cd3a6472145afac42"
                },
                {
                    "url": "https://git.kernel.org/stable/c/ac5883a8890a11c00b32a19949a25d4afeaa2f5a"
                },
                {
                    "url": "https://git.kernel.org/stable/c/f75f4abeec4c04b600a15b50c89a481f1e7435ee"
                },
                {
                    "url": "https://git.kernel.org/stable/c/41249fff507387c3323b198d0052faed08b14de4"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b0898362188e05b2202656058cc32d98fabf3bac"
                },
                {
                    "url": "https://git.kernel.org/stable/c/7409ff6393a67ff9838d0ae1bd102fb5f020d07a"
                },
                {
                    "url": "https://git.kernel.org/stable/c/e8aaf3134bc5e943048eefe9f2ddaabf41d92b1a"
                },
                {
                    "url": "https://git.kernel.org/stable/c/e23e1e981247feb3c7d0236fe58aceb685f234ae"
                },
                {
                    "url": "https://git.kernel.org/stable/c/0caf6d9922192dd1afa8dc2131abfb4df1443b9f"
                }
            ],
            "title": "af_netlink: Fix shift out of bounds in group mask calculation",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}