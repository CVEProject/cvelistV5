{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-34087",
        "assignerOrgId": "83251b91-4cc7-4094-a5c7-464a1b83ea10",
        "state": "PUBLISHED",
        "assignerShortName": "VulnCheck",
        "dateReserved": "2025-04-15T19:15:22.551Z",
        "datePublished": "2025-07-03T19:46:49.017Z",
        "dateUpdated": "2025-07-03T19:46:49.017Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "modules": [
                        "domain parameter",
                        "Web Admin Interface"
                    ],
                    "product": "Web",
                    "vendor": "Pi-hole LLC",
                    "versions": [
                        {
                            "lessThanOrEqual": "3.3",
                            "status": "affected",
                            "version": "*",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Denis Andzakovic"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>An authenticated command injection vulnerability exists in Pi-hole versions up to 3.3. When adding a domain to the allowlist via the web interface, the <code>domain</code> parameter is not properly sanitized, allowing an attacker to append OS commands to the domain string. These commands are executed on the underlying operating system with the privileges of the Pi-hole service user.</p><p><br></p><p>This behavior was present in the legacy AdminLTE interface and has since been patched in later versions.<br></p>"
                        }
                    ],
                    "value": "An authenticated command injection vulnerability exists in Pi-hole versions up to 3.3. When adding a domain to the allowlist via the web interface, the domain parameter is not properly sanitized, allowing an attacker to append OS commands to the domain string. These commands are executed on the underlying operating system with the privileges of the Pi-hole service user.\n\n\n\n\nThis behavior was present in the legacy AdminLTE interface and has since been patched in later versions."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-88",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-88 OS Command Injection"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-137",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-137 Parameter Injection"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "PRESENT",
                        "attackVector": "NETWORK",
                        "baseScore": 9,
                        "baseSeverity": "CRITICAL",
                        "privilegesRequired": "LOW",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "HIGH",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "HIGH",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-78",
                            "description": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "83251b91-4cc7-4094-a5c7-464a1b83ea10",
                "shortName": "VulnCheck",
                "dateUpdated": "2025-07-03T19:46:49.017Z"
            },
            "references": [
                {
                    "tags": [
                        "exploit"
                    ],
                    "url": "https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/unix/http/pihole_whitelist_exec.rb"
                },
                {
                    "tags": [
                        "product"
                    ],
                    "url": "https://pi-hole.net/"
                },
                {
                    "tags": [
                        "vendor-advisory",
                        "patch"
                    ],
                    "url": "https://github.com/pi-hole/web/releases/tag/v4.0"
                },
                {
                    "tags": [
                        "third-party-advisory",
                        "exploit"
                    ],
                    "url": "https://pulsesecurity.co.nz/advisories/pihole-v3.3-vulns"
                },
                {
                    "tags": [
                        "third-party-advisory"
                    ],
                    "url": "https://vulncheck.com/advisories/pihole-adminlte-whitelist-rce"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Pi-Hole AdminLTE Whitelist (now 'Web Allowlist') Remote Command Execution",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}