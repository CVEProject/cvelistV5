{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-37893",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-04-16T04:51:23.964Z",
        "datePublished": "2025-04-18T07:01:28.856Z",
        "dateUpdated": "2025-04-25T10:06:50.345Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-04-25T10:06:50.345Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nLoongArch: BPF: Fix off-by-one error in build_prologue()\n\nVincent reported that running BPF progs with tailcalls on LoongArch\ncauses kernel hard lockup. Debugging the issues shows that the JITed\nimage missing a jirl instruction at the end of the epilogue.\n\nThere are two passes in JIT compiling, the first pass set the flags and\nthe second pass generates JIT code based on those flags. With BPF progs\nmixing bpf2bpf and tailcalls, build_prologue() generates N insns in the\nfirst pass and then generates N+1 insns in the second pass. This makes\nepilogue_offset off by one and we will jump to some unexpected insn and\ncause lockup. Fix this by inserting a nop insn."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/loongarch/net/bpf_jit.c",
                        "arch/loongarch/net/bpf_jit.h"
                    ],
                    "versions": [
                        {
                            "version": "5dc615520c4dfb358245680f1904bad61116648e",
                            "lessThan": "b3ffad2f02db4aace6799fe0049508b8925eae45",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "5dc615520c4dfb358245680f1904bad61116648e",
                            "lessThan": "205a2182c51ffebaef54d643e3745e720cded08b",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "5dc615520c4dfb358245680f1904bad61116648e",
                            "lessThan": "c74d95a5679741ef428974ab788f5b0758dc78ae",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "5dc615520c4dfb358245680f1904bad61116648e",
                            "lessThan": "48b904de2408af5f936f0e03f48dfcddeab58aa0",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "5dc615520c4dfb358245680f1904bad61116648e",
                            "lessThan": "7e2586991e36663c9bc48c828b83eab180ad30a9",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/loongarch/net/bpf_jit.c",
                        "arch/loongarch/net/bpf_jit.h"
                    ],
                    "versions": [
                        {
                            "version": "6.1",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "6.1",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.6.87",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12.23",
                            "lessThanOrEqual": "6.12.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.13.11",
                            "lessThanOrEqual": "6.13.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.14.2",
                            "lessThanOrEqual": "6.14.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.15-rc1",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/b3ffad2f02db4aace6799fe0049508b8925eae45"
                },
                {
                    "url": "https://git.kernel.org/stable/c/205a2182c51ffebaef54d643e3745e720cded08b"
                },
                {
                    "url": "https://git.kernel.org/stable/c/c74d95a5679741ef428974ab788f5b0758dc78ae"
                },
                {
                    "url": "https://git.kernel.org/stable/c/48b904de2408af5f936f0e03f48dfcddeab58aa0"
                },
                {
                    "url": "https://git.kernel.org/stable/c/7e2586991e36663c9bc48c828b83eab180ad30a9"
                }
            ],
            "title": "LoongArch: BPF: Fix off-by-one error in build_prologue()",
            "x_generator": {
                "engine": "bippy-1.1.0"
            }
        }
    }
}