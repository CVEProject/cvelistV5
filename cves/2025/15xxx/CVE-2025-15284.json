{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2025-15284",
        "assignerOrgId": "7ffcee3d-2c14-4c3e-b844-86c6a321a158",
        "state": "PUBLISHED",
        "assignerShortName": "harborist",
        "dateReserved": "2025-12-29T21:36:51.399Z",
        "datePublished": "2025-12-29T22:56:45.240Z",
        "dateUpdated": "2026-02-10T20:06:42.111Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://npmjs.com/qs",
                    "defaultStatus": "affected",
                    "modules": [
                        "parse"
                    ],
                    "packageName": "qs",
                    "repo": "https://github.com/ljharb/qs",
                    "versions": [
                        {
                            "status": "affected",
                            "version": "< 6.14.1",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Improper Input Validation vulnerability in qs (parse modules) allows HTTP DoS.<p>This issue affects qs: &lt; 6.14.1.</p><h3><br>Summary</h3><p></p><p>The <code>arrayLimit</code>&nbsp;option in qs did not enforce limits for bracket notation (<code>a[]=1&amp;a[]=2</code>), only for indexed notation (<code>a[0]=1</code>). This is a consistency bug; <code>arrayLimit</code>&nbsp;should apply uniformly across all array notations.</p><p><strong>Note:</strong>&nbsp;The default <code>parameterLimit</code>&nbsp;of 1000 effectively mitigates the DoS scenario originally described. With default options, bracket notation cannot produce arrays larger than <code>parameterLimit</code>&nbsp;regardless of <code>arrayLimit</code>, because each <code>a[]=value</code>consumes one parameter slot. The severity has been reduced accordingly.</p><h3>Details</h3><p></p><p>The <code>arrayLimit</code>&nbsp;option only checked limits for indexed notation (<code>a[0]=1&amp;a[1]=2</code>) but did not enforce it for bracket notation (<code>a[]=1&amp;a[]=2</code>).</p><p><strong>Vulnerable code</strong>&nbsp;(<code>lib/parse.js:159-162</code>):</p><div><pre>if (root === '[]' &amp;&amp; options.parseArrays) {\n    obj = utils.combine([], leaf);  // No arrayLimit check\n}</pre><div></div></div><p><strong>Working code</strong>&nbsp;(<code>lib/parse.js:175</code>):</p><div><pre>else if (index &lt;= options.arrayLimit) {  // Limit checked here\n    obj = [];\n    obj[index] = leaf;\n}</pre><div></div></div><p>The bracket notation handler at line 159 uses <code>utils.combine([], leaf)</code>&nbsp;without validating against <code>options.arrayLimit</code>, while indexed notation at line 175 checks <code>index &lt;= options.arrayLimit</code>&nbsp;before creating arrays.</p><p></p><h3>PoC</h3><p><strong></strong></p><div><pre>const qs = require('qs');\nconst result = qs.parse('a[]=1&amp;a[]=2&amp;a[]=3&amp;a[]=4&amp;a[]=5&amp;a[]=6', { arrayLimit: 5 });\nconsole.log(result.a.length);  // Output: 6 (should be max 5)</pre><div></div></div><p><strong>Note on parameterLimit interaction:</strong>&nbsp;The original advisory's \"DoS demonstration\" claimed a length of 10,000, but <code>parameterLimit</code>&nbsp;(default: 1000) caps parsing to 1,000 parameters. With default options, the actual output is 1,000, not 10,000.</p><h3>Impact</h3><p></p><span style=\"background-color: rgb(255, 255, 255);\">Consistency bug in </span><code>arrayLimit</code><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;enforcement. With default </span><code>parameterLimit</code><span style=\"background-color: rgb(255, 255, 255);\">, the practical DoS risk is negligible since </span><code>parameterLimit</code><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;already caps the total number of parsed parameters (and thus array elements from bracket notation). The risk increases only when </span><code>parameterLimit</code><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;is explicitly set to a very high value.</span>"
                        }
                    ],
                    "value": "Improper Input Validation vulnerability in qs (parse modules) allows HTTP DoS.This issue affects qs: < 6.14.1.\n\n\nSummary\n\nThe arrayLimit option in qs did not enforce limits for bracket notation (a[]=1&a[]=2), only for indexed notation (a[0]=1). This is a consistency bug; arrayLimit should apply uniformly across all array notations.\n\nNote: The default parameterLimit of 1000 effectively mitigates the DoS scenario originally described. With default options, bracket notation cannot produce arrays larger than parameterLimit regardless of arrayLimit, because each a[]=valueconsumes one parameter slot. The severity has been reduced accordingly.\n\nDetails\n\nThe arrayLimit option only checked limits for indexed notation (a[0]=1&a[1]=2) but did not enforce it for bracket notation (a[]=1&a[]=2).\n\nVulnerable code (lib/parse.js:159-162):\n\nif (root === '[]' && options.parseArrays) {\n    obj = utils.combine([], leaf);  // No arrayLimit check\n}\n\n\n\n\n\nWorking code (lib/parse.js:175):\n\nelse if (index <= options.arrayLimit) {  // Limit checked here\n    obj = [];\n    obj[index] = leaf;\n}\n\n\n\n\n\nThe bracket notation handler at line 159 uses utils.combine([], leaf) without validating against options.arrayLimit, while indexed notation at line 175 checks index <= options.arrayLimit before creating arrays.\n\n\n\nPoC\n\nconst qs = require('qs');\nconst result = qs.parse('a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6', { arrayLimit: 5 });\nconsole.log(result.a.length);  // Output: 6 (should be max 5)\n\n\n\n\n\nNote on parameterLimit interaction: The original advisory's \"DoS demonstration\" claimed a length of 10,000, but parameterLimit (default: 1000) caps parsing to 1,000 parameters. With default options, the actual output is 1,000, not 10,000.\n\nImpact\n\nConsistency bug in arrayLimit enforcement. With default parameterLimit, the practical DoS risk is negligible since parameterLimit already caps the total number of parsed parameters (and thus array elements from bracket notation). The risk increases only when parameterLimit is explicitly set to a very high value."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-469",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-469 HTTP DoS"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "PRESENT",
                        "attackVector": "NETWORK",
                        "baseScore": 6.3,
                        "baseSeverity": "MEDIUM",
                        "exploitMaturity": "NOT_DEFINED",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "LOW",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "NONE",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:L",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "LOW",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "NONE",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                },
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "LOW",
                        "baseScore": 3.7,
                        "baseSeverity": "LOW",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-20",
                            "description": "CWE-20 Improper Input Validation",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "7ffcee3d-2c14-4c3e-b844-86c6a321a158",
                "shortName": "harborist",
                "dateUpdated": "2026-02-10T20:06:42.111Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p"
                },
                {
                    "tags": [
                        "patch"
                    ],
                    "url": "https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "arrayLimit bypass in bracket notation allows DoS via memory exhaustion",
            "x_generator": {
                "engine": "Vulnogram 0.5.0"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2025-12-30T14:55:26.031863Z",
                                "id": "CVE-2025-15284",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "yes"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2025-12-30T15:57:41.402Z"
                }
            }
        ]
    }
}