{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-4144",
        "assignerOrgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
        "state": "PUBLISHED",
        "assignerShortName": "cloudflare",
        "dateReserved": "2025-04-30T16:39:00.801Z",
        "datePublished": "2025-05-01T00:50:27.543Z",
        "dateUpdated": "2025-05-01T00:50:27.543Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/cloudflare",
                    "defaultStatus": "unaffected",
                    "packageName": "workers-oauth-provider",
                    "repo": "https://github.com/cloudflare/workers-oauth-provider",
                    "versions": [
                        {
                            "lessThan": "0.0.5",
                            "status": "affected",
                            "version": "0",
                            "versionType": "git"
                        }
                    ]
                }
            ],
            "datePublic": "2025-04-30T16:30:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p><span style=\"background-color: transparent;\">PKCE was implemented in the OAuth implementation in workers-oauth-provider that is part of </span><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/workers-mcp\"><span style=\"background-color: transparent;\">MCP framework</span></a>. However, it<span style=\"background-color: transparent;\">&nbsp;was found that an attacker could cause the check to be skipped.</span></p><b><br></b><p><span style=\"background-color: transparent;\">Fixed in:</span></p><p> </p><p><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/cloudflare/workers-oauth-provider/pull/27\"><span style=\"background-color: transparent;\">https://github.com/cloudflare/workers-oauth-provider/pull/27</span></a></p><b><br></b><p><span style=\"background-color: transparent;\">Impact: </span></p><p><span style=\"background-color: transparent;\">PKCE is a defense-in-depth mechanism against certain kinds of attacks and was an optional extension in OAuth 2.0 which became required in the OAuth 2.1 draft. (Note that the MCP specification requires OAuth 2.1.).&nbsp;</span><span style=\"background-color: transparent;\">This bug completely bypasses PKCE protection.</span></p><br>"
                        }
                    ],
                    "value": "PKCE was implemented in the OAuth implementation in workers-oauth-provider that is part of  MCP framework https://github.com/cloudflare/workers-mcp . However, it was found that an attacker could cause the check to be skipped.\n\n\nFixed in:\n\n \n\n https://github.com/cloudflare/workers-oauth-provider/pull/27 https://github.com/cloudflare/workers-oauth-provider/pull/27 \n\n\nImpact: \n\nPKCE is a defense-in-depth mechanism against certain kinds of attacks and was an optional extension in OAuth 2.0 which became required in the OAuth 2.1 draft. (Note that the MCP specification requires OAuth 2.1.). This bug completely bypasses PKCE protection."
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "NETWORK",
                        "baseScore": 5.3,
                        "baseSeverity": "MEDIUM",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "AMBER",
                        "subAvailabilityImpact": "NONE",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "NONE",
                        "userInteraction": "PASSIVE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/U:Amber",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "NONE",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "LOW",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-287",
                            "description": "CWE-287 Improper Authentication",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
                "shortName": "cloudflare",
                "dateUpdated": "2025-05-01T00:50:27.543Z"
            },
            "references": [
                {
                    "url": "https://github.com/cloudflare/workers-oauth-provider/pull/27"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "PKCE bypass via downgrade attack",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}