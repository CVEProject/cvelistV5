{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-6264",
        "assignerOrgId": "9974b330-7714-4307-a722-5648477acda7",
        "state": "PUBLISHED",
        "assignerShortName": "rapid7",
        "dateReserved": "2025-06-19T00:22:46.272Z",
        "datePublished": "2025-06-20T02:01:33.993Z",
        "dateUpdated": "2025-06-20T02:01:33.993Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Windows",
                        "MacOS",
                        "Linux"
                    ],
                    "product": "Velociraptor",
                    "repo": "https://github.com/Velocidex/velociraptor",
                    "vendor": "Rapid7",
                    "versions": [
                        {
                            "lessThan": "0.74.3",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Users who rely on artifacts to prevent dangerous actions from already privileged users."
                        }
                    ],
                    "value": "Users who rely on artifacts to prevent dangerous actions from already privileged users."
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "We thank Christian Fünfhaus  from Deutsche Bahn CSIRT for identifying and reporting this issue"
                }
            ],
            "datePublic": "2025-06-19T00:44:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Velociraptor allows collection of VQL queries packaged into Artifacts from endpoints. These artifacts can be used to do anything and usually run with elevated permissions.&nbsp; To limit access to some dangerous artifact, Velociraptor allows for those to require high permissions like EXECVE to launch.<br><br>The Admin.Client.UpdateClientConfig is an artifact used to update the client's configuration. This artifact did not enforce an additional required permission, allowing users with COLLECT_CLIENT permissions (normally given by the \"Investigator\" role) to collect it from endpoints and update the configuration. <br><br>This can lead to arbitrary command execution and endpoint takeover.<br><br>To successfully exploit this vulnerability the user must already have access to collect artifacts from the endpoint (i.e. have the COLLECT_CLIENT given typically by the \"Investigator' role).&nbsp;"
                        }
                    ],
                    "value": "Velociraptor allows collection of VQL queries packaged into Artifacts from endpoints. These artifacts can be used to do anything and usually run with elevated permissions.  To limit access to some dangerous artifact, Velociraptor allows for those to require high permissions like EXECVE to launch.\n\nThe Admin.Client.UpdateClientConfig is an artifact used to update the client's configuration. This artifact did not enforce an additional required permission, allowing users with COLLECT_CLIENT permissions (normally given by the \"Investigator\" role) to collect it from endpoints and update the configuration. \n\nThis can lead to arbitrary command execution and endpoint takeover.\n\nTo successfully exploit this vulnerability the user must already have access to collect artifacts from the endpoint (i.e. have the COLLECT_CLIENT given typically by the \"Investigator' role)."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-30",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-30 Hijacking a Privileged Thread of Execution"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "LOW",
                        "baseScore": 4.7,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "HIGH",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-276",
                            "description": "CWE-276 Incorrect Default Permissions",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "9974b330-7714-4307-a722-5648477acda7",
                "shortName": "rapid7",
                "dateUpdated": "2025-06-20T02:01:33.993Z"
            },
            "references": [
                {
                    "url": "https://docs.velociraptor.app/announcements/advisories/cve-2025-6264/"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "title": "Velociraptor priviledge escalation via UpdateConfig artifact",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "To better restrict the types of artifacts users can run, the `basic artifacts` mechanism should be used as described&nbsp;<a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.velociraptor.app/docs/artifacts/security/#basic-artifacts\">https://docs.velociraptor.app/docs/artifacts/security/#basic-artifacts</a><br><br>To detect unintended privilege escalations in custom artifacts, users should run the artifact verifier as described here&nbsp;<a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.velociraptor.app/docs/artifacts/security/#restricting-dangerous-client-artifacts\">https://docs.velociraptor.app/docs/artifacts/security/#restricting-dangerous-client-artifacts</a>"
                        }
                    ],
                    "value": "To better restrict the types of artifacts users can run, the `basic artifacts` mechanism should be used as described  https://docs.velociraptor.app/docs/artifacts/security/#basic-artifacts \n\nTo detect unintended privilege escalations in custom artifacts, users should run the artifact verifier as described here  https://docs.velociraptor.app/docs/artifacts/security/#restricting-dangerous-client-artifacts"
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}