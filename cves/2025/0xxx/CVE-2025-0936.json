{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-0936",
        "assignerOrgId": "c8b34d1a-69ae-45c3-88fe-f3b3d44f39b7",
        "state": "PUBLISHED",
        "assignerShortName": "Arista",
        "dateReserved": "2025-01-31T17:18:43.715Z",
        "datePublished": "2025-05-07T22:52:25.444Z",
        "dateUpdated": "2025-05-07T22:52:25.444Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "EOS",
                    "vendor": "Arista Networks",
                    "versions": [
                        {
                            "lessThanOrEqual": "4.33.1",
                            "status": "affected",
                            "version": "4.33.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThanOrEqual": "4.32.3M",
                            "status": "affected",
                            "version": "4.32.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThanOrEqual": "4.31.5M",
                            "status": "affected",
                            "version": "4.31.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThanOrEqual": "4.30.9M",
                            "status": "affected",
                            "version": "4.30.1F",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>In order to be vulnerable to CVE-2025-0936, one or both of the following conditions must be met:</p><ul><li>OpenConfig must be enabled with a gNOI server with accounting enabled </li><li>OpenConfig must be enabled with a gNOI server with tracing enabled which includes any of:<br><ul><li>service/9</li><li>interceptor/9 </li><li>transport_socketcli/9 </li></ul></li></ul><p>If OpenConfig is enabled with a gNOI server with accounting enabled, this will be shown in the following CLI output:</p><pre>switch(config)#show management api gnmi\nTransport: default\nEnabled: <span style=\"background-color: rgb(255, 255, 0);\">yes</span>\nServer: running on port 6030, in default VRF\nSSL profile: none\nQoS DSCP: none\nAuthorization required: no\nAccounting requests: <span style=\"background-color: rgb(255, 255, 0);\">yes</span>\nNotification timestamp: last change time\nListen addresses: ::\nAuthentication username priority: x509-spiffe, metadata, x509-common-name\n</pre><div>&nbsp;</div><p>If OpenConfig is not configured or OpenConfig is configured with no gNOI server, then there is no exposure to this issue and the message will look like.</p><pre>switch(config)#show management api gnmi\nEnabled: <span style=\"background-color: rgb(255, 255, 0);\">no transports enabled</span>\n</pre><div>&nbsp;</div><p>To see the tracing enabled for OpenConfig, run:</p><pre>switch(config)#show running-config section trace | grep OpenConfig\ntrace OpenConfig setting <span style=\"background-color: rgb(255, 255, 0);\">service/9,interceptor/9,transport_socketcli/9</span>\n</pre><div>&nbsp;</div><p>Note: gRPC-based streaming via TerminAttr to CloudVision is not affected by this vulnerability.</p><br>"
                        }
                    ],
                    "value": "In order to be vulnerable to CVE-2025-0936, one or both of the following conditions must be met:\n\n  *  OpenConfig must be enabled with a gNOI server with accounting enabled \n  *  OpenConfig must be enabled with a gNOI server with tracing enabled which includes any of:\n  *  service/9\n  *  interceptor/9 \n  *  transport_socketcli/9 \n\n\n\n\n\nIf OpenConfig is enabled with a gNOI server with accounting enabled, this will be shown in the following CLI output:\n\nswitch(config)#show management api gnmi\nTransport: default\nEnabled: yes\nServer: running on port 6030, in default VRF\nSSL profile: none\nQoS DSCP: none\nAuthorization required: no\nAccounting requests: yes\nNotification timestamp: last change time\nListen addresses: ::\nAuthentication username priority: x509-spiffe, metadata, x509-common-name\n\n\n \n\nIf OpenConfig is not configured or OpenConfig is configured with no gNOI server, then there is no exposure to this issue and the message will look like.\n\nswitch(config)#show management api gnmi\nEnabled: no transports enabled\n\n\n \n\nTo see the tracing enabled for OpenConfig, run:\n\nswitch(config)#show running-config section trace | grep OpenConfig\ntrace OpenConfig setting service/9,interceptor/9,transport_socketcli/9\n\n\n \n\nNote: gRPC-based streaming via TerminAttr to CloudVision is not affected by this vulnerability."
                }
            ],
            "datePublic": "2025-05-06T15:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<span style=\"background-color: rgb(255, 255, 255);\">On affected platforms running Arista EOS with a gNMI transport enabled, running the gNOI File TransferToRemote RPC with credentials for a remote server may cause these remote-server credentials to be logged or accounted on the local EOS device or possibly on other remote accounting servers (i.e. TACACS, RADIUS, etc).</span><br>"
                        }
                    ],
                    "value": "On affected platforms running Arista EOS with a gNMI transport enabled, running the gNOI File TransferToRemote RPC with credentials for a remote server may cause these remote-server credentials to be logged or accounted on the local EOS device or possibly on other remote accounting servers (i.e. TACACS, RADIUS, etc)."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-37",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-37 Retrieve Embedded Sensitive Data"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-256",
                            "description": "CWE-256",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "c8b34d1a-69ae-45c3-88fe-f3b3d44f39b7",
                "shortName": "Arista",
                "dateUpdated": "2025-05-07T22:52:25.444Z"
            },
            "references": [
                {
                    "url": "https://www.arista.com/en/support/advisories-notices/security-advisory/21394-security-advisory-0117"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see <a target=\"_blank\" rel=\"nofollow\" href=\"https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades\">EOS User Manual: Upgrades and Downgrades</a></p><div>CVE-2025-0936 has been fixed in the following releases:</div><ul><li>4.30.10M and later releases in the 4.30.x train</li><li>4.31.7M and later releases in the 4.31.x train</li><li>4.32.5M and later releases in the 4.32.x train</li><li>4.33.2F and later releases</li></ul><br>"
                        }
                    ],
                    "value": "The recommended resolution is to upgrade to a remediated software version at your earliest convenience. Arista recommends customers move to the latest version of each release that contains all the fixes listed below. For more information about upgrading see  EOS User Manual: Upgrades and Downgrades https://www.arista.com/en/um-eos/eos-upgrades-and-downgrades \n\nCVE-2025-0936 has been fixed in the following releases:\n\n  *  4.30.10M and later releases in the 4.30.x train\n  *  4.31.7M and later releases in the 4.31.x train\n  *  4.32.5M and later releases in the 4.32.x train\n  *  4.33.2F and later releases"
                }
            ],
            "source": {
                "defect": [
                    "BUG 1045796"
                ],
                "discovery": "INTERNAL"
            },
            "title": "On affected platforms running Arista EOS with a gNMI transport enabled, running the gNOI File TransferToRemote RPC with credentials for a remote server may cause these remote-server credentials to be logged or accounted on the local EOS device or possibly",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>There are a number of possible workarounds:</p><h4>Option 1 - disable accounting/logging for the OpenConfig transport</h4><p>For example to disable accounting for transport named “default”:</p><pre>switch(config)#management api gnmi\nswitch(config-mgmt-api-gnmi)#transport grpc default\nswitch(config-gnmi-transport-default)#<span style=\"background-color: rgb(255, 255, 0);\">no accounting requests</span>\n</pre><div>&nbsp;</div><p>to disable logging for the OpenConfig agent, run:</p><pre>switch(config)#no trace OpenConfig setting\n</pre><div>&nbsp;</div><h4>Option 2 - disable the gNOI File service entirely</h4><p>To disable the gNOI File service, override the OCGNOIFileToggle, then restart OpenConfig to load the changes</p><pre>switch#bash timeout 100 echo \"OCGNOIFileToggle=0\" &gt;&gt; /mnt/flash/toggle_override\nswitch#agent OpenConfig terminate \n</pre><div>&nbsp;</div><p>Disabling the gNOI File service will mean that gNOI clients will no longer be able to call any gNOI File RPCs</p><h4>Option 3 - block the TransferToRemote RPC using gNSI Authz</h4><p>For releases with gNSI Authz (EOS 4.31.0F and later releases), the TransferToRemote RPC can be blocked using gNSI Authz.</p><p>First enable gNSI Authz service by adding the following config:</p><pre>switch(config)#management api gnsi\nswitch(config-mgmt-api-gnsi)#service authz\n</pre><p>Where [NAME] is the name of the running gNMI transport</p><p>Adding this config will cause the named gNMI transport to reload.</p><p>Next update the authz policy to block access to the TransferToRemote RPC. This can be done directly on the system by updating the Authz policy file and waiting at least 10 seconds for OpenConfig to reload the changes:</p><pre>switch#bash timeout 100 echo \"{\\\"name\\\":\\\"block gNOI TransferToRemote policy\\\",\\\"allow_rules\\\":[{\\\"name\\\":\\\"allow_all\\\"}],\\\"deny_rules\\\":[{\\\"name\\\":\\\"no-one-can-use-gnoi-transfer-to-remote\\\",\\\"request\\\":{\\\"paths\\\":[\\\"/gnoi.file.File/TransferToRemote\\\"]}}]}\" | sudo tee /persist/sys/gnsi/authz/policy.json &amp;&amp; sleep 11\n</pre><div>&nbsp;</div><p>This will cause attempts to run the TransferToRemote RPC to fail with a “PermissionDenied” error code.</p><br>"
                        }
                    ],
                    "value": "There are a number of possible workarounds:\n\nOption 1 - disable accounting/logging for the OpenConfig transportFor example to disable accounting for transport named “default”:\n\nswitch(config)#management api gnmi\nswitch(config-mgmt-api-gnmi)#transport grpc default\nswitch(config-gnmi-transport-default)#no accounting requests\n\n\n \n\nto disable logging for the OpenConfig agent, run:\n\nswitch(config)#no trace OpenConfig setting\n\n\n \n\nOption 2 - disable the gNOI File service entirelyTo disable the gNOI File service, override the OCGNOIFileToggle, then restart OpenConfig to load the changes\n\nswitch#bash timeout 100 echo \"OCGNOIFileToggle=0\" >> /mnt/flash/toggle_override\nswitch#agent OpenConfig terminate \n\n\n \n\nDisabling the gNOI File service will mean that gNOI clients will no longer be able to call any gNOI File RPCs\n\nOption 3 - block the TransferToRemote RPC using gNSI AuthzFor releases with gNSI Authz (EOS 4.31.0F and later releases), the TransferToRemote RPC can be blocked using gNSI Authz.\n\nFirst enable gNSI Authz service by adding the following config:\n\nswitch(config)#management api gnsi\nswitch(config-mgmt-api-gnsi)#service authz\n\n\nWhere [NAME] is the name of the running gNMI transport\n\nAdding this config will cause the named gNMI transport to reload.\n\nNext update the authz policy to block access to the TransferToRemote RPC. This can be done directly on the system by updating the Authz policy file and waiting at least 10 seconds for OpenConfig to reload the changes:\n\nswitch#bash timeout 100 echo \"{\\\"name\\\":\\\"block gNOI TransferToRemote policy\\\",\\\"allow_rules\\\":[{\\\"name\\\":\\\"allow_all\\\"}],\\\"deny_rules\\\":[{\\\"name\\\":\\\"no-one-can-use-gnoi-transfer-to-remote\\\",\\\"request\\\":{\\\"paths\\\":[\\\"/gnoi.file.File/TransferToRemote\\\"]}}]}\" | sudo tee /persist/sys/gnsi/authz/policy.json && sleep 11\n\n\n \n\nThis will cause attempts to run the TransferToRemote RPC to fail with a “PermissionDenied” error code."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}