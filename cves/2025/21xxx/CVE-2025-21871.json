{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-21871",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-12-29T08:45:45.781Z",
        "datePublished": "2025-03-27T13:38:23.461Z",
        "dateUpdated": "2025-03-27T13:38:23.461Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-03-27T13:38:23.461Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntee: optee: Fix supplicant wait loop\n\nOP-TEE supplicant is a user-space daemon and it's possible for it\nbe hung or crashed or killed in the middle of processing an OP-TEE\nRPC call. It becomes more complicated when there is incorrect shutdown\nordering of the supplicant process vs the OP-TEE client application which\ncan eventually lead to system hang-up waiting for the closure of the\nclient application.\n\nAllow the client process waiting in kernel for supplicant response to\nbe killed rather than indefinitely waiting in an unkillable state. Also,\na normal uninterruptible wait should not have resulted in the hung-task\nwatchdog getting triggered, but the endless loop would.\n\nThis fixes issues observed during system reboot/shutdown when supplicant\ngot hung for some reason or gets crashed/killed which lead to client\ngetting hung in an unkillable state. It in turn lead to system being in\nhung up state requiring hard power off/on to recover."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/tee/optee/supp.c"
                    ],
                    "versions": [
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "3eb4911364c764572e9db4ab900a57689a54e8ce",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "0180cf0373f84fff61b16f8c062553a13dd7cfca",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "c0a9a948159153be145f9471435695373904ee6d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "ec18520f5edc20a00c34a8c9fdd6507c355e880f",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "d61cc1a435e6894bfb0dd3370c6f765d2d12825d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "fd9d2d6124c293e40797a080adf8a9c237efd8b8",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "21234efe2a8474a6d2d01ea9573319de7858ce44",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "4fb0a5eb364d239722e745c02aef0dbd4e0f1ad2",
                            "lessThan": "70b0d6b0a199c5a3ee6c72f5e61681ed6f759612",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/tee/optee/supp.c"
                    ],
                    "versions": [
                        {
                            "version": "4.12",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.12",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.291",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.235",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.179",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.130",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.6.80",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12.17",
                            "lessThanOrEqual": "6.12.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.13.5",
                            "lessThanOrEqual": "6.13.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.14",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/3eb4911364c764572e9db4ab900a57689a54e8ce"
                },
                {
                    "url": "https://git.kernel.org/stable/c/0180cf0373f84fff61b16f8c062553a13dd7cfca"
                },
                {
                    "url": "https://git.kernel.org/stable/c/c0a9a948159153be145f9471435695373904ee6d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/ec18520f5edc20a00c34a8c9fdd6507c355e880f"
                },
                {
                    "url": "https://git.kernel.org/stable/c/d61cc1a435e6894bfb0dd3370c6f765d2d12825d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/fd9d2d6124c293e40797a080adf8a9c237efd8b8"
                },
                {
                    "url": "https://git.kernel.org/stable/c/21234efe2a8474a6d2d01ea9573319de7858ce44"
                },
                {
                    "url": "https://git.kernel.org/stable/c/70b0d6b0a199c5a3ee6c72f5e61681ed6f759612"
                }
            ],
            "title": "tee: optee: Fix supplicant wait loop",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}