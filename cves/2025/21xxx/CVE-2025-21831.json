{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-21831",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-12-29T08:45:45.776Z",
        "datePublished": "2025-03-06T16:22:33.443Z",
        "dateUpdated": "2025-03-24T15:41:04.034Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-03-24T15:41:04.034Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Avoid putting some root ports into D3 on TUXEDO Sirius Gen1\n\ncommit 9d26d3a8f1b0 (\"PCI: Put PCIe ports into D3 during suspend\") sets the\npolicy that all PCIe ports are allowed to use D3.  When the system is\nsuspended if the port is not power manageable by the platform and won't be\nused for wakeup via a PME this sets up the policy for these ports to go\ninto D3hot.\n\nThis policy generally makes sense from an OSPM perspective but it leads to\nproblems with wakeup from suspend on the TUXEDO Sirius 16 Gen 1 with a\nspecific old BIOS. This manifests as a system hang.\n\nOn the affected Device + BIOS combination, add a quirk for the root port of\nthe problematic controller to ensure that these root ports are not put into\nD3hot at suspend.\n\nThis patch is based on\n\n  https://lore.kernel.org/linux-pci/20230708214457.1229-2-mario.limonciello@amd.com\n\nbut with the added condition both in the documentation and in the code to\napply only to the TUXEDO Sirius 16 Gen 1 with a specific old BIOS and only\nthe affected root ports."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/pci/fixup.c"
                    ],
                    "versions": [
                        {
                            "version": "9d26d3a8f1b0c442339a235f9508bdad8af91043",
                            "lessThan": "8852e056e297df1d8635ee7504e780d3184e45d0",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "9d26d3a8f1b0c442339a235f9508bdad8af91043",
                            "lessThan": "5ee3dd6e59b834e4d66e8b16fc684749ee40a257",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "9d26d3a8f1b0c442339a235f9508bdad8af91043",
                            "lessThan": "a78dfe50fffe6058afed2bb04c50c2c9a16664ee",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "9d26d3a8f1b0c442339a235f9508bdad8af91043",
                            "lessThan": "b1049f2d68693c80a576c4578d96774a68df2bad",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/pci/fixup.c"
                    ],
                    "versions": [
                        {
                            "version": "4.8",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.8",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.6.78",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12.14",
                            "lessThanOrEqual": "6.12.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.13.3",
                            "lessThanOrEqual": "6.13.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.14",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/8852e056e297df1d8635ee7504e780d3184e45d0"
                },
                {
                    "url": "https://git.kernel.org/stable/c/5ee3dd6e59b834e4d66e8b16fc684749ee40a257"
                },
                {
                    "url": "https://git.kernel.org/stable/c/a78dfe50fffe6058afed2bb04c50c2c9a16664ee"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b1049f2d68693c80a576c4578d96774a68df2bad"
                }
            ],
            "title": "PCI: Avoid putting some root ports into D3 on TUXEDO Sirius Gen1",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}