{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2025-65947",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2025-11-18T16:14:56.691Z",
        "datePublished": "2025-11-21T22:15:30.181Z",
        "dateUpdated": "2025-11-21T22:15:30.181Z"
    },
    "containers": {
        "cna": {
            "title": "thread-amount is Vulnerable to Resource Exhaustion (Memory and Handle Leaks) on Windows and macOS",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-400",
                            "lang": "en",
                            "description": "CWE-400: Uncontrolled Resource Consumption",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-772",
                            "lang": "en",
                            "description": "CWE-772: Missing Release of Resource after Effective Lifetime",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "NONE",
                        "vulnAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "NONE",
                        "subAvailabilityImpact": "NONE",
                        "baseScore": 8.7,
                        "baseSeverity": "HIGH",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N",
                        "version": "4.0"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/jzeuzs/thread-amount/security/advisories/GHSA-jf9p-2fv9-2jp2",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/jzeuzs/thread-amount/security/advisories/GHSA-jf9p-2fv9-2jp2"
                },
                {
                    "name": "https://github.com/jzeuzs/thread-amount/pull/29",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/jzeuzs/thread-amount/pull/29"
                },
                {
                    "name": "https://github.com/jzeuzs/thread-amount/commit/28860d4a38286609cb884c13b5b7941edc2390e5",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/jzeuzs/thread-amount/commit/28860d4a38286609cb884c13b5b7941edc2390e5"
                }
            ],
            "affected": [
                {
                    "vendor": "jzeuzs",
                    "product": "thread-amount",
                    "versions": [
                        {
                            "version": "< 0.2.2",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2025-11-21T22:15:30.181Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "thread-amount is a tool that gets the amount of threads in the current process. Prior to version 0.2.2, there are resource leaks when querying thread counts on Windows and Apple platforms. In Windows platforms, the thread_amount function calls CreateToolhelp32Snapshot but fails to close the returned HANDLE using CloseHandle. Repeated calls to this function will cause the handle count of the process to grow indefinitely, eventually leading to system instability or process termination when the handle limit is reached. In Apple platforms, the thread_amount function calls task_threads (via Mach kernel APIs) which allocates memory for the thread list. The function fails to deallocate this memory using vm_deallocate. Repeated calls will result in a steady memory leak, eventually causing the process to be killed by the OOM (Out of Memory) killer. This issue has been patched in version 0.2.2."
                }
            ],
            "source": {
                "advisory": "GHSA-jf9p-2fv9-2jp2",
                "discovery": "UNKNOWN"
            }
        }
    }
}