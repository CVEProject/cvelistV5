{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-5151",
        "assignerOrgId": "1af790b2-7ee1-4545-860a-a788eba489b5",
        "state": "PUBLISHED",
        "assignerShortName": "VulDB",
        "dateReserved": "2025-05-24T17:43:41.379Z",
        "datePublished": "2025-05-25T16:31:05.540Z",
        "dateUpdated": "2025-05-28T17:38:24.723Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "1af790b2-7ee1-4545-860a-a788eba489b5",
                "shortName": "VulDB",
                "dateUpdated": "2025-05-25T16:31:05.540Z"
            },
            "title": "defog-ai introspect analysis_tools.py execute_analysis_code_safely code injection",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "cweId": "CWE-94",
                            "lang": "en",
                            "description": "Code Injection"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "cweId": "CWE-74",
                            "lang": "en",
                            "description": "Injection"
                        }
                    ]
                }
            ],
            "affected": [
                {
                    "vendor": "defog-ai",
                    "product": "introspect",
                    "versions": [
                        {
                            "version": "0.1.0",
                            "status": "affected"
                        },
                        {
                            "version": "0.1.1",
                            "status": "affected"
                        },
                        {
                            "version": "0.1.2",
                            "status": "affected"
                        },
                        {
                            "version": "0.1.3",
                            "status": "affected"
                        },
                        {
                            "version": "0.1.4",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A vulnerability classified as critical has been found in defog-ai introspect up to 0.1.4. This affects the function execute_analysis_code_safely of the file introspect/backend/tools/analysis_tools.py. The manipulation of the argument code leads to code injection. It is possible to launch the attack on the local host. The exploit has been disclosed to the public and may be used. The patch is named 502. It is recommended to apply a patch to fix this issue. The code maintainer explains, that \"[they] have added some workarounds to address this in #502, but will not be implementing a full fix. This is because this repo is meant to be run in a docker environment, which will significantly mitigate potential security risks. Having said that, we have added a SECURITY section in our README to make this clearer to users.\""
                },
                {
                    "lang": "de",
                    "value": "Es wurde eine Schwachstelle in defog-ai introspect bis 0.1.4 entdeckt. Sie wurde als kritisch eingestuft. Betroffen hiervon ist die Funktion execute_analysis_code_safely der Datei introspect/backend/tools/analysis_tools.py. Mittels Manipulieren des Arguments code mit unbekannten Daten kann eine code injection-Schwachstelle ausgenutzt werden. Der Angriff muss lokal erfolgen. Der Exploit steht zur öffentlichen Verfügung. Der Patch wird als 502 bezeichnet. Als bestmögliche Massnahme wird Patching empfohlen."
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "version": "4.0",
                        "baseScore": 4.8,
                        "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N",
                        "baseSeverity": "MEDIUM"
                    }
                },
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "baseScore": 5.3,
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
                        "baseSeverity": "MEDIUM"
                    }
                },
                {
                    "cvssV3_0": {
                        "version": "3.0",
                        "baseScore": 5.3,
                        "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
                        "baseSeverity": "MEDIUM"
                    }
                },
                {
                    "cvssV2_0": {
                        "version": "2.0",
                        "baseScore": 4.3,
                        "vectorString": "AV:L/AC:L/Au:S/C:P/I:P/A:P"
                    }
                }
            ],
            "timeline": [
                {
                    "time": "2025-05-24T00:00:00.000Z",
                    "lang": "en",
                    "value": "Advisory disclosed"
                },
                {
                    "time": "2025-05-24T02:00:00.000Z",
                    "lang": "en",
                    "value": "VulDB entry created"
                },
                {
                    "time": "2025-05-24T19:48:51.000Z",
                    "lang": "en",
                    "value": "VulDB entry last update"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "ybdesire (VulDB User)",
                    "type": "reporter"
                }
            ],
            "references": [
                {
                    "url": "https://vuldb.com/?id.310239",
                    "name": "VDB-310239 | defog-ai introspect analysis_tools.py execute_analysis_code_safely code injection",
                    "tags": [
                        "vdb-entry",
                        "technical-description"
                    ]
                },
                {
                    "url": "https://vuldb.com/?ctiid.310239",
                    "name": "VDB-310239 | CTI Indicators (IOB, IOC, TTP, IOA)",
                    "tags": [
                        "signature",
                        "permissions-required"
                    ]
                },
                {
                    "url": "https://vuldb.com/?submit.574809",
                    "name": "Submit #574809 | defog-ai introspect v0.1.0 to v0.1.4 Code Injection",
                    "tags": [
                        "third-party-advisory"
                    ]
                },
                {
                    "url": "https://github.com/defog-ai/introspect/issues/495",
                    "tags": [
                        "issue-tracking"
                    ]
                },
                {
                    "url": "https://github.com/defog-ai/introspect/issues/495#issuecomment-2894640278",
                    "tags": [
                        "issue-tracking"
                    ]
                },
                {
                    "url": "https://github.com/defog-ai/introspect/issues/495#issue-3036141048",
                    "tags": [
                        "exploit",
                        "issue-tracking"
                    ]
                },
                {
                    "url": "https://github.com/defog-ai/introspect/pull/502",
                    "tags": [
                        "issue-tracking",
                        "patch"
                    ]
                }
            ]
        },
        "adp": [
            {
                "references": [
                    {
                        "url": "https://github.com/defog-ai/introspect/issues/495#issuecomment-2894640278",
                        "tags": [
                            "exploit"
                        ]
                    }
                ],
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2025-05-27T14:21:21.934860Z",
                                "id": "CVE-2025-5151",
                                "options": [
                                    {
                                        "Exploitation": "poc"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2025-05-28T17:38:24.723Z"
                }
            }
        ]
    }
}