{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-57917",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-01-19T11:50:08.375Z",
        "datePublished": "2025-01-19T11:52:37.866Z",
        "dateUpdated": "2025-01-23T17:01:06.824Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-01-23T17:01:06.824Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntopology: Keep the cpumask unchanged when printing cpumap\n\nDuring fuzz testing, the following warning was discovered:\n\n different return values (15 and 11) from vsnprintf(\"%*pbl\n \", ...)\n\n test:keyward is WARNING in kvasprintf\n WARNING: CPU: 55 PID: 1168477 at lib/kasprintf.c:30 kvasprintf+0x121/0x130\n Call Trace:\n  kvasprintf+0x121/0x130\n  kasprintf+0xa6/0xe0\n  bitmap_print_to_buf+0x89/0x100\n  core_siblings_list_read+0x7e/0xb0\n  kernfs_file_read_iter+0x15b/0x270\n  new_sync_read+0x153/0x260\n  vfs_read+0x215/0x290\n  ksys_read+0xb9/0x160\n  do_syscall_64+0x56/0x100\n  entry_SYSCALL_64_after_hwframe+0x78/0xe2\n\nThe call trace shows that kvasprintf() reported this warning during the\nprinting of core_siblings_list. kvasprintf() has several steps:\n\n (1) First, calculate the length of the resulting formatted string.\n\n (2) Allocate a buffer based on the returned length.\n\n (3) Then, perform the actual string formatting.\n\n (4) Check whether the lengths of the formatted strings returned in\n     steps (1) and (2) are consistent.\n\nIf the core_cpumask is modified between steps (1) and (3), the lengths\nobtained in these two steps may not match. Indeed our test includes cpu\nhotplugging, which should modify core_cpumask while printing.\n\nTo fix this issue, cache the cpumask into a temporary variable before\ncalling cpumap_print_{list, cpumask}_to_buf(), to keep it unchanged\nduring the printing process."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/base/topology.c"
                    ],
                    "versions": [
                        {
                            "version": "bb9ec13d156e85dfd6a8afd0bb61ccf5736ed257",
                            "lessThan": "1c7818e2746e747838a3de1687e89eac7b947f08",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "bb9ec13d156e85dfd6a8afd0bb61ccf5736ed257",
                            "lessThan": "ca47e933a900492d89dcf5db18a99c28bd4a742d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "bb9ec13d156e85dfd6a8afd0bb61ccf5736ed257",
                            "lessThan": "b02cf1d27e460ab2b3e1c8c9ce472d562cad2e8d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "bb9ec13d156e85dfd6a8afd0bb61ccf5736ed257",
                            "lessThan": "360596e7fe319a5db1b5fb34a3952862ae53c924",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "bb9ec13d156e85dfd6a8afd0bb61ccf5736ed257",
                            "lessThan": "cbd399f78e23ad4492c174fc5e6b3676dba74a52",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/base/topology.c"
                    ],
                    "versions": [
                        {
                            "version": "5.15",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "5.15",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.177",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.125",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.6.72",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12.10",
                            "lessThanOrEqual": "6.12.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.13",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/1c7818e2746e747838a3de1687e89eac7b947f08"
                },
                {
                    "url": "https://git.kernel.org/stable/c/ca47e933a900492d89dcf5db18a99c28bd4a742d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b02cf1d27e460ab2b3e1c8c9ce472d562cad2e8d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/360596e7fe319a5db1b5fb34a3952862ae53c924"
                },
                {
                    "url": "https://git.kernel.org/stable/c/cbd399f78e23ad4492c174fc5e6b3676dba74a52"
                }
            ],
            "title": "topology: Keep the cpumask unchanged when printing cpumap",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}