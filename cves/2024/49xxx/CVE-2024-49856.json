{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-49856",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-10-21T12:17:06.016Z",
        "datePublished": "2024-10-21T12:18:48.123Z",
        "dateUpdated": "2024-10-21T12:18:48.123Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-10-21T12:18:48.123Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/sgx: Fix deadlock in SGX NUMA node search\n\nWhen the current node doesn't have an EPC section configured by firmware\nand all other EPC sections are used up, CPU can get stuck inside the\nwhile loop that looks for an available EPC page from remote nodes\nindefinitely, leading to a soft lockup. Note how nid_of_current will\nnever be equal to nid in that while loop because nid_of_current is not\nset in sgx_numa_mask.\n\nAlso worth mentioning is that it's perfectly fine for the firmware not\nto setup an EPC section on a node. While setting up an EPC section on\neach node can enhance performance, it is not a requirement for\nfunctionality.\n\nRework the loop to start and end on *a* node that has SGX memory. This\navoids the deadlock looking for the current SGX-lacking node to show up\nin the loop when it never will."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/kernel/cpu/sgx/main.c"
                    ],
                    "versions": [
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "40fb64257dab",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "20c96d0aaabf",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "fb2d057539ed",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "0f89fb4042c0",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "8132510c9158",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "901ddbb9ecf5",
                            "lessThan": "9c9368440104",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/kernel/cpu/sgx/main.c"
                    ],
                    "versions": [
                        {
                            "version": "5.13",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "5.13",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.15.168",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.1.113",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.6.54",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.10.13",
                            "lessThanOrEqual": "6.10.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.11.2",
                            "lessThanOrEqual": "6.11.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.12-rc1",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/40fb64257dab507d86b5f1f2a62f3669ef0c91a8"
                },
                {
                    "url": "https://git.kernel.org/stable/c/20c96d0aaabfe361fc2a11c173968dc67feadbbf"
                },
                {
                    "url": "https://git.kernel.org/stable/c/fb2d057539eda67ec7cfc369bf587e6518a9b99d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/0f89fb4042c08fd143bfc28af08bf6c8a0197eea"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8132510c915815e6b537ab937d94ed66893bc7b8"
                },
                {
                    "url": "https://git.kernel.org/stable/c/9c936844010466535bd46ea4ce4656ef17653644"
                }
            ],
            "title": "x86/sgx: Fix deadlock in SGX NUMA node search",
            "x_generator": {
                "engine": "bippy-c9c4e1df01b2"
            }
        }
    }
}