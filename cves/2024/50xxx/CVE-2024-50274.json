{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-50274",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-10-21T19:36:19.983Z",
        "datePublished": "2024-11-19T01:30:13.973Z",
        "dateUpdated": "2024-12-19T09:37:04.833Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-12-19T09:37:04.833Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: avoid vport access in idpf_get_link_ksettings\n\nWhen the device control plane is removed or the platform\nrunning device control plane is rebooted, a reset is detected\non the driver. On driver reset, it releases the resources and\nwaits for the reset to complete. If the reset fails, it takes\nthe error path and releases the vport lock. At this time if the\nmonitoring tools tries to access link settings, it call traces\nfor accessing released vport pointer.\n\nTo avoid it, move link_speed_mbps to netdev_priv structure\nwhich removes the dependency on vport pointer and the vport lock\nin idpf_get_link_ksettings. Also use netif_carrier_ok()\nto check the link status and adjust the offsetof to use link_up\ninstead of link_speed_mbps."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/net/ethernet/intel/idpf/idpf.h",
                        "drivers/net/ethernet/intel/idpf/idpf_ethtool.c",
                        "drivers/net/ethernet/intel/idpf/idpf_lib.c",
                        "drivers/net/ethernet/intel/idpf/idpf_virtchnl.c"
                    ],
                    "versions": [
                        {
                            "version": "02cbfba1add5bd9088c7d14c6b93b77a6ea8f3bb",
                            "lessThan": "fa4d906ad0fb63a980a1d586a061c78ea1a345ba",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "02cbfba1add5bd9088c7d14c6b93b77a6ea8f3bb",
                            "lessThan": "81d2fb4c7c18a3b36ba3e00b9d5b753107472d75",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/net/ethernet/intel/idpf/idpf.h",
                        "drivers/net/ethernet/intel/idpf/idpf_ethtool.c",
                        "drivers/net/ethernet/intel/idpf/idpf_lib.c",
                        "drivers/net/ethernet/intel/idpf/idpf_virtchnl.c"
                    ],
                    "versions": [
                        {
                            "version": "6.7",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "6.7",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.11.8",
                            "lessThanOrEqual": "6.11.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/fa4d906ad0fb63a980a1d586a061c78ea1a345ba"
                },
                {
                    "url": "https://git.kernel.org/stable/c/81d2fb4c7c18a3b36ba3e00b9d5b753107472d75"
                }
            ],
            "title": "idpf: avoid vport access in idpf_get_link_ksettings",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}