{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-8365",
        "assignerOrgId": "67fedba0-ff2e-4543-ba5b-aa93e87718cc",
        "state": "PUBLISHED",
        "assignerShortName": "HashiCorp",
        "dateReserved": "2024-08-30T22:54:58.745Z",
        "datePublished": "2024-09-02T01:30:56.618Z",
        "dateUpdated": "2024-09-04T17:18:36.980Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "64 bit",
                        "32 bit",
                        "x86",
                        "ARM",
                        "MacOS",
                        "Windows",
                        "Linux"
                    ],
                    "product": "Vault",
                    "repo": "https://github.com/hashicorp/vault",
                    "vendor": "HashiCorp",
                    "versions": [
                        {
                            "lessThan": "1.17.5",
                            "status": "affected",
                            "version": "1.17.3",
                            "versionType": "semver"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "64 bit",
                        "32 bit",
                        "x86",
                        "ARM",
                        "MacOS",
                        "Windows",
                        "Linux"
                    ],
                    "product": "Vault Enterprise",
                    "repo": "https://github.com/hashicorp/vault",
                    "vendor": "HashiCorp",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "1.16.9",
                                    "status": "unaffected"
                                },
                                {
                                    "at": "1.17.3",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "1.17.5",
                            "status": "affected",
                            "version": "1.16.7",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC’d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9.</p><br/>"
                        }
                    ],
                    "value": "Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC’d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-118",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-118: Collect and Analyze Information"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "baseScore": 6.2,
                        "baseSeverity": "MEDIUM",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:N/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-532",
                            "description": "CWE-532: Insertion of Sensitive Information into Log File",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "67fedba0-ff2e-4543-ba5b-aa93e87718cc",
                "shortName": "HashiCorp",
                "dateUpdated": "2024-09-04T17:18:36.980Z"
            },
            "references": [
                {
                    "url": "https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices/"
                }
            ],
            "source": {
                "advisory": "HCSEC-2024-HCSEC-2024-18",
                "discovery": "INTERNAL"
            },
            "title": "Vault Leaks AppRole Client Tokens And Accessor in Audit Log"
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-09-03T13:51:10.738646Z",
                                "id": "CVE-2024-8365",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-09-03T13:51:51.953Z"
                }
            }
        ]
    }
}