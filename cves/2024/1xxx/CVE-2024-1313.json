{
    "dataType": "CVE_RECORD",
    "cveMetadata": {
        "cveId": "CVE-2024-1313",
        "assignerOrgId": "57da9224-a3e2-4646-9d0e-c4dc2e05e7da",
        "state": "PUBLISHED",
        "assignerShortName": "GRAFANA",
        "dateReserved": "2024-02-07T15:15:07.330Z",
        "datePublished": "2024-03-26T17:24:25.956Z",
        "dateUpdated": "2024-03-26T17:24:25.956Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Linux"
                    ],
                    "product": "Grafana",
                    "repo": "https://github.com/grafana/grafana",
                    "vendor": "Grafana",
                    "versions": [
                        {
                            "lessThan": "9.5.18",
                            "status": "affected",
                            "version": "9.5.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "10.0.13",
                            "status": "affected",
                            "version": "10.0.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "10.1.9",
                            "status": "affected",
                            "version": "10.1.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "10.2.6",
                            "status": "affected",
                            "version": "10.2.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "10.3.5",
                            "status": "affected",
                            "version": "10.3.0",
                            "versionType": "semver"
                        },
                        {
                            "status": "unaffected",
                            "version": "10.4.0"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "To be exposed to this issue, a grafana instance must be configured with multiple organizations and have the snapshots feature turned on.<br>"
                        }
                    ],
                    "value": "To be exposed to this issue, a grafana instance must be configured with multiple organizations and have the snapshots feature turned on.\n"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Ravid Mazon"
                },
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Jay Chen"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "It is possible for a user in a different organization from the owner of a snapshot to bypass authorization and delete a snapshot by issuing a DELETE request to /api/snapshots/&lt;key&gt; using its view key. This functionality is intended to only be available to individuals with the permission to write/edit to the snapshot in question, but due to a bug in the authorization logic, deletion requests issued by an unprivileged user in a different organization than the snapshot owner are treated as authorized.<br><p><br>Grafana Labs would like to thank Ravid Mazon and Jay Chen of Palo \nAlto Research for discovering and disclosing this vulnerability.<br><br>This issue affects Grafana: from 9.5.0 before 9.5.18, from 10.0.0 before 10.0.13, from 10.1.0 before 10.1.9, from 10.2.0 before 10.2.6, from 10.3.0 before 10.3.5.<br><br></p>"
                        }
                    ],
                    "value": "It is possible for a user in a different organization from the owner of a snapshot to bypass authorization and delete a snapshot by issuing a DELETE request to /api/snapshots/<key> using its view key. This functionality is intended to only be available to individuals with the permission to write/edit to the snapshot in question, but due to a bug in the authorization logic, deletion requests issued by an unprivileged user in a different organization than the snapshot owner are treated as authorized.\n\nGrafana Labs would like to thank Ravid Mazon and Jay Chen of Palo \nAlto Research for discovering and disclosing this vulnerability.\n\nThis issue affects Grafana: from 9.5.0 before 9.5.18, from 10.0.0 before 10.0.13, from 10.1.0 before 10.1.9, from 10.2.0 before 10.2.6, from 10.3.0 before 10.3.5.\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-137",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-137 Parameter Injection"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-639",
                            "description": "CWE-639 Authorization Bypass Through User-Controlled Key",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "57da9224-a3e2-4646-9d0e-c4dc2e05e7da",
                "shortName": "GRAFANA",
                "dateUpdated": "2024-03-26T17:24:25.956Z"
            },
            "references": [
                {
                    "url": "https://grafana.com/security/security-advisories/cve-2024-1313/"
                },
                {
                    "url": "https://security.netapp.com/advisory/ntap-20240524-0008/"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "title": "Users outside an organization can delete a snapshot with its key",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    },
    "dataVersion": "5.1"
}