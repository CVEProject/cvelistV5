{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2024-4447",
        "assignerOrgId": "5b9d93f2-25c7-46b4-ab60-d201718c9dd8",
        "state": "PUBLISHED",
        "assignerShortName": "dotCMS",
        "dateReserved": "2024-05-02T19:24:56.680Z",
        "datePublished": "2024-07-26T02:02:32.506Z",
        "dateUpdated": "2026-01-29T10:25:19.929Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "dotCMS core",
                    "vendor": "dotCMS",
                    "versions": [
                        {
                            "lessThan": "23.01.20",
                            "status": "affected",
                            "version": "4.2.1",
                            "versionType": "git"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>In the <strong>System → Maintenance</strong> tool, the Logged Users tab surfaces sessionId data for all users via the Direct Web Remoting API (<code>UserSessionAjax.getSessionList.dwr</code>) calls. While this is information that would and should be available to admins who possess \"Sign In As\" powers, admins who otherwise lack this privilege would still be able to utilize the session IDs to imitate other users.</p>\n<p>While this is a very small attack vector that requires very high permissions to execute, its danger lies principally in obfuscating attribution; all Sign In As operations are attributed appropriately in the log files, and a malicious administrator could use this information to render their dealings untraceable — including those admins who have not been granted this ability — such as by using a session ID to generate an API token.</p>Fixed in:&nbsp;24.07.12 / 23.01.20 LTS / 23.10.24v13 LTS / 24.04.24v5 LTS<br><p><br>This was the original found by researcher Zakaria Agharghar.<br><br></p>\n<p>2. Later, on October 20, 2025, another researcher (Chris O’Neill) found additional affected DWR Endpoints that are vulnerable to Information Disclosure, namely and in addition to the original found of \"UserSessionAjax.getSessionList.dwr - Session ID exposure\":</p>\n<ol>\n<li>UserAjax.getUsersList.dwr - Enumerate all users with IDs, names, emails</li>\n<li>RoleAjax.getUserRole.dwr - Get user role information</li>\n<li>RoleAjax.getRole.dwr - Get role details</li>\n<li>RoleAjax.getRolePermissions.dwr - View role permissions</li>\n<li>RoleAjax.isPermissionableInheriting.dwr - Check permission inheritance</li>\n<li>RoleAjax.getCurrentCascadePermissionsJobs.dwr - View permission cascade jobs</li>\n<li>ThreadMonitorTool.getThreads.dwr - Monitor system threads; and,</li>\n<li>CRITICAL - Privilege Escalation: RoleAjax.saveRolePermission.dwr - Modify role permissions</li>\n</ol>\n<p>Overall CVSS for the above findings:</p>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L</a></li>\n<li>Score: 9.1 (Critical)</li>\n</ul><br>"
                        }
                    ],
                    "value": "In the System → Maintenance tool, the Logged Users tab surfaces sessionId data for all users via the Direct Web Remoting API (UserSessionAjax.getSessionList.dwr) calls. While this is information that would and should be available to admins who possess \"Sign In As\" powers, admins who otherwise lack this privilege would still be able to utilize the session IDs to imitate other users.\n\n\nWhile this is a very small attack vector that requires very high permissions to execute, its danger lies principally in obfuscating attribution; all Sign In As operations are attributed appropriately in the log files, and a malicious administrator could use this information to render their dealings untraceable — including those admins who have not been granted this ability — such as by using a session ID to generate an API token.\n\nFixed in: 24.07.12 / 23.01.20 LTS / 23.10.24v13 LTS / 24.04.24v5 LTS\n\nThis was the original found by researcher Zakaria Agharghar.\n\n\n\n\n2. Later, on October 20, 2025, another researcher (Chris O’Neill) found additional affected DWR Endpoints that are vulnerable to Information Disclosure, namely and in addition to the original found of \"UserSessionAjax.getSessionList.dwr - Session ID exposure\":\n\n\n\n  *  UserAjax.getUsersList.dwr - Enumerate all users with IDs, names, emails\n\n  *  RoleAjax.getUserRole.dwr - Get user role information\n\n  *  RoleAjax.getRole.dwr - Get role details\n\n  *  RoleAjax.getRolePermissions.dwr - View role permissions\n\n  *  RoleAjax.isPermissionableInheriting.dwr - Check permission inheritance\n\n  *  RoleAjax.getCurrentCascadePermissionsJobs.dwr - View permission cascade jobs\n\n  *  ThreadMonitorTool.getThreads.dwr - Monitor system threads; and,\n\n  *  CRITICAL - Privilege Escalation: RoleAjax.saveRolePermission.dwr - Modify role permissions\n\n\nOverall CVSS for the above findings:\n\n\n\n  *   CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L \n\n  *  Score: 9.1 (Critical)"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-131",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-131 Resource Leak Exposure"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "LOW",
                        "baseScore": 9.9,
                        "baseSeverity": "CRITICAL",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-863",
                            "description": "CWE-863 Incorrect Authorization",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "5b9d93f2-25c7-46b4-ab60-d201718c9dd8",
                "shortName": "dotCMS",
                "dateUpdated": "2026-01-29T10:25:19.929Z"
            },
            "references": [
                {
                    "url": "https://www.dotcms.com/security/SI-72"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-07-26T15:21:48.573627Z",
                                "id": "CVE-2024-4447",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-07-26T15:22:09.063Z"
                }
            },
            {
                "providerMetadata": {
                    "orgId": "af854a3a-2127-422b-91ae-364da2661108",
                    "shortName": "CVE",
                    "dateUpdated": "2024-08-01T20:40:47.160Z"
                },
                "title": "CVE Program Container",
                "references": [
                    {
                        "url": "https://www.dotcms.com/security/SI-72",
                        "tags": [
                            "x_transferred"
                        ]
                    }
                ]
            }
        ]
    }
}