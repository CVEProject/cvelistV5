{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-39558",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "state": "PUBLISHED",
        "assignerShortName": "juniper",
        "dateReserved": "2024-06-25T15:12:53.247Z",
        "datePublished": "2024-07-10T22:40:44.365Z",
        "dateUpdated": "2024-08-13T20:36:57.726Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Junos OS",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R3-S10",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.2R3-S7",
                            "status": "affected",
                            "version": "21.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.4R3-S6",
                            "status": "affected",
                            "version": "21.4",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.1R3-S5",
                            "status": "affected",
                            "version": "22.1",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.2R3-S3",
                            "status": "affected",
                            "version": "22.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.3R3",
                            "status": "affected",
                            "version": "22.3",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.4R2",
                            "status": "affected",
                            "version": "22.4",
                            "versionType": "semver"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "product": "Junos OS Evolved",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R3-S10-EVO",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.2*-EVO",
                            "status": "affected",
                            "version": "21.2R1-EVO",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.4R3-S9-EVO",
                            "status": "affected",
                            "version": "21.4-EVO",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.1R3-S5-EVO",
                            "status": "affected",
                            "version": "22.1-EVO",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.2R3-S3-EVO",
                            "status": "affected",
                            "version": "22.2-EVO",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.3R3-EVO",
                            "status": "affected",
                            "version": "22.3-EVO",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.4R2-EVO",
                            "status": "affected",
                            "version": "22.4-EVO",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "This issue only affects systems with PIM and MoFRR enabled.&nbsp; For example:<br><br><tt>[ protocols pim ]<br>[ routing-options multicast stream-protection ]</tt>"
                        }
                    ],
                    "value": "This issue only affects systems with PIM and MoFRR enabled.  For example:\n\n[ protocols pim ]\n[ routing-options multicast stream-protection ]"
                }
            ],
            "datePublic": "2024-07-10T16:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "An Unchecked Return Value vulnerability in the Routing Protocol Daemon (rpd) on Juniper Networks Junos OS and Juniper Networks Junos OS Evolved allows a logically adjacent, unauthenticated attacker sending a specific PIM packet to cause rpd to crash and restart, resulting in a Denial of Service (DoS), when PIM is configured with Multicast-only Fast Reroute (MoFRR). Continued receipt and processing of this packet may create a sustained Denial of Service (DoS) condition.<br><br>This issue is observed on Junos and Junos Evolved platforms where PIM is configured along with MoFRR. MoFRR tries to select the active path, but due to an internal timing issue, rpd is unable to select the forwarding next-hop towards the source, resulting in an rpd crash.<br><br><p>This issue affects:</p><p>Junos OS: <br></p><ul><li>All versions before 20.4R3-S10, </li><li>from 21.2 before 21.2R3-S7, </li><li>from 21.4 before 21.4R3-S6, </li><li>from 22.1 before 22.1R3-S5, </li><li>from 22.2 before 22.2R3-S3, </li><li>from 22.3 before 22.3R3, </li><li>from 22.4 before 22.4R2;&nbsp;</li></ul><p></p><p>Junos OS Evolved: <br></p><ul><li>All versions before 20.4R3-S10 -EVO,</li><li>All versions of 21.2-EVO,</li><li>from 21.4-EVO before 21.4R3-S9-EVO,</li><li>from 22.1-EVO before 22.1R3-S5-EVO,</li><li>from 22.2-EVO before 22.2R3-S3-EVO,</li><li>from 22.3-EVO before 22.3R3-EVO,</li><li>from 22.4-EVO before 22.4R2-EVO.</li></ul><p></p>"
                        }
                    ],
                    "value": "An Unchecked Return Value vulnerability in the Routing Protocol Daemon (rpd) on Juniper Networks Junos OS and Juniper Networks Junos OS Evolved allows a logically adjacent, unauthenticated attacker sending a specific PIM packet to cause rpd to crash and restart, resulting in a Denial of Service (DoS), when PIM is configured with Multicast-only Fast Reroute (MoFRR). Continued receipt and processing of this packet may create a sustained Denial of Service (DoS) condition.\n\nThis issue is observed on Junos and Junos Evolved platforms where PIM is configured along with MoFRR. MoFRR tries to select the active path, but due to an internal timing issue, rpd is unable to select the forwarding next-hop towards the source, resulting in an rpd crash.\n\nThis issue affects:\n\nJunos OS: \n\n\n  *  All versions before 20.4R3-S10, \n  *  from 21.2 before 21.2R3-S7, \n  *  from 21.4 before 21.4R3-S6, \n  *  from 22.1 before 22.1R3-S5, \n  *  from 22.2 before 22.2R3-S3, \n  *  from 22.3 before 22.3R3, \n  *  from 22.4 before 22.4R2; \n\n\n\n\nJunos OS Evolved: \n\n\n  *  All versions before 20.4R3-S10 -EVO,\n  *  All versions of 21.2-EVO,\n  *  from 21.4-EVO before 21.4R3-S9-EVO,\n  *  from 22.1-EVO before 22.1R3-S5-EVO,\n  *  from 22.2-EVO before 22.2R3-S3-EVO,\n  *  from 22.3-EVO before 22.3R3-EVO,\n  *  from 22.4-EVO before 22.4R2-EVO."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                        }
                    ],
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "ADJACENT_NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                },
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "AUTOMATIC",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "ADJACENT",
                        "baseScore": 7.1,
                        "baseSeverity": "HIGH",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "LOW",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "NONE",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L/R:A",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "NONE",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-252",
                            "description": "CWE-252 Unchecked Return Value",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2024-08-08T20:50:13.375Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://supportportal.juniper.net/JSA83018"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "The following software releases have been updated to resolve this specific issue:<br>Junos: 20.4R3-S10, 21.2R3-S7, 21.4R3-S6, 22.1R3-S5, 22.2R3-S3, 22.3R3, 22.4R2, 23.2R1, and all subsequent releases.<br>Junos OS Evolved: 20.4R3-S10-EVO, 21.4R3-S9-EVO, 22.1R3-S5-EVO, 22.2R3-S3-EVO, 22.3R3-EVO, 22.4R2-EVO, 23.2R1-EVO, and all subsequent releases.<br>"
                        }
                    ],
                    "value": "The following software releases have been updated to resolve this specific issue:\nJunos: 20.4R3-S10, 21.2R3-S7, 21.4R3-S6, 22.1R3-S5, 22.2R3-S3, 22.3R3, 22.4R2, 23.2R1, and all subsequent releases.\nJunos OS Evolved: 20.4R3-S10-EVO, 21.4R3-S9-EVO, 22.1R3-S5-EVO, 22.2R3-S3-EVO, 22.3R3-EVO, 22.4R2-EVO, 23.2R1-EVO, and all subsequent releases."
                }
            ],
            "source": {
                "advisory": "JSA83018",
                "defect": [
                    "1709038"
                ],
                "discovery": "INTERNAL"
            },
            "timeline": [
                {
                    "lang": "en",
                    "time": "2024-07-10T16:00:00.000Z",
                    "value": "Initial Publication"
                },
                {
                    "lang": "en",
                    "time": "2024-08-08T21:00:00.000Z",
                    "value": "Updated list of EVO affected and fixed releases"
                }
            ],
            "title": "Junos OS and Junos OS Evolved: Receipt of specific PIM packet causes rpd crash when PIM is configured along with MoFRR",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "There are no known workarounds for this issue."
                        }
                    ],
                    "value": "There are no known workarounds for this issue."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        },
        "adp": [
            {
                "affected": [
                    {
                        "vendor": "juniper",
                        "product": "junos_os",
                        "cpes": [
                            "cpe:2.3:o:juniper:junos_os:*:*:*:*:*:*:*:*"
                        ],
                        "defaultStatus": "unaffected",
                        "versions": [
                            {
                                "version": "0",
                                "status": "affected",
                                "lessThan": "20.4R3-S10",
                                "versionType": "semver"
                            },
                            {
                                "version": "21.2",
                                "status": "affected",
                                "lessThan": "21.2R3-S7",
                                "versionType": "semver"
                            },
                            {
                                "version": "21.4",
                                "status": "affected",
                                "lessThan": "21.4R3-S6",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.1",
                                "status": "affected",
                                "lessThan": "22.1R3-S5",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.2",
                                "status": "affected",
                                "lessThan": "22.2R3-S3",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.3",
                                "status": "affected",
                                "lessThan": "22.3R3",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.4",
                                "status": "affected",
                                "lessThan": "22.4R2",
                                "versionType": "semver"
                            }
                        ]
                    },
                    {
                        "vendor": "juniper",
                        "product": "junos_os_evolved",
                        "cpes": [
                            "cpe:2.3:o:juniper:junos_os_evolved:*:*:*:*:*:*:*:*"
                        ],
                        "defaultStatus": "unaffected",
                        "versions": [
                            {
                                "version": "0",
                                "status": "affected",
                                "lessThan": "20.4R3-S10-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "21.2R1-EVO",
                                "status": "affected",
                                "lessThan": "21.2*-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "21.4-EVO",
                                "status": "affected",
                                "lessThan": "21.4R3-S9-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.1-EVO",
                                "status": "affected",
                                "lessThan": "22.1R3-S5-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.2-EVO",
                                "status": "affected",
                                "lessThan": "22.2R3-S3-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.3-EVO",
                                "status": "affected",
                                "lessThan": "22.3R3-EVO",
                                "versionType": "semver"
                            },
                            {
                                "version": "22.4-EVO",
                                "status": "affected",
                                "lessThan": "22.4R2-EVO",
                                "versionType": "semver"
                            }
                        ]
                    }
                ],
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-07-11T14:25:31.554466Z",
                                "id": "CVE-2024-39558",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-08-13T20:36:57.726Z"
                }
            },
            {
                "providerMetadata": {
                    "orgId": "af854a3a-2127-422b-91ae-364da2661108",
                    "shortName": "CVE",
                    "dateUpdated": "2024-08-02T04:26:15.994Z"
                },
                "title": "CVE Program Container",
                "references": [
                    {
                        "tags": [
                            "vendor-advisory",
                            "x_transferred"
                        ],
                        "url": "https://supportportal.juniper.net/JSA83018"
                    }
                ]
            }
        ]
    }
}