{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-47056",
        "assignerOrgId": "4e531c38-7a33-45d3-98dd-d909c0d8852e",
        "state": "PUBLISHED",
        "assignerShortName": "Mautic",
        "dateReserved": "2024-09-17T13:41:00.584Z",
        "datePublished": "2025-05-28T16:24:57.162Z",
        "dateUpdated": "2025-05-28T16:24:57.162Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://packagist.org",
                    "defaultStatus": "unaffected",
                    "packageName": "mautic/core",
                    "product": "Mautic",
                    "repo": "https://github.com/mautic/mautic",
                    "vendor": "Mautic",
                    "versions": [
                        {
                            "lessThan": "< 6.0.2, < 5.2.6, <4.4.16",
                            "status": "affected",
                            "version": "> 4.4.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "r3ky"
                },
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "r3ky"
                },
                {
                    "lang": "en",
                    "type": "analyst",
                    "value": "Lenon Leite"
                },
                {
                    "lang": "en",
                    "type": "remediation developer",
                    "value": "Nick Vanpraet"
                },
                {
                    "lang": "en",
                    "type": "remediation reviewer",
                    "value": "Patryk Gruszka"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<h3>Summary</h3><p>This advisory addresses a security vulnerability in Mautic where sensitive <code>.env</code>&nbsp;configuration files may be directly accessible via a web browser. This exposure could lead to the disclosure of sensitive information, including database credentials, API keys, and other critical system configurations.</p><p>Sensitive Information Disclosure via <code>.env</code>&nbsp;File Exposure: The <code>.env</code>&nbsp;file, which typically contains environment variables and sensitive application configurations, is directly accessible via a web browser due to missing web server configurations that restrict access to such files. This allows an unauthenticated attacker to view the contents of this file by simply navigating to its URL.</p><h3>Mitigation</h3><p>Update Mautic to the latest Mautic version.</p><p><b>By default, Mautic does not use </b><code><b>.env</b></code><b>&nbsp;files for production data.</b></p><p><strong>For Apache users:</strong>&nbsp;Ensure your web server is configured to respect <code>.htaccess</code>&nbsp;files.</p><p><strong>For Nginx users:</strong>&nbsp;As Nginx does not inherently support <code>.htaccess</code>&nbsp;files, you must manually add a configuration block to your Nginx server configuration to deny access to <code>.env</code>&nbsp;files. Add the following to your Nginx configuration for the Mautic site:</p><div><pre>location ~ /\\.env {\n    deny all;\n}</pre><div></div></div><p>After modifying your Nginx configuration, remember to reload or restart your Nginx service for the changes to take effect.</p><br>"
                        }
                    ],
                    "value": "SummaryThis advisory addresses a security vulnerability in Mautic where sensitive .env configuration files may be directly accessible via a web browser. This exposure could lead to the disclosure of sensitive information, including database credentials, API keys, and other critical system configurations.\n\nSensitive Information Disclosure via .env File Exposure: The .env file, which typically contains environment variables and sensitive application configurations, is directly accessible via a web browser due to missing web server configurations that restrict access to such files. This allows an unauthenticated attacker to view the contents of this file by simply navigating to its URL.\n\nMitigationUpdate Mautic to the latest Mautic version.\n\nBy default, Mautic does not use .env files for production data.\n\nFor Apache users: Ensure your web server is configured to respect .htaccess files.\n\nFor Nginx users: As Nginx does not inherently support .htaccess files, you must manually add a configuration block to your Nginx server configuration to deny access to .env files. Add the following to your Nginx configuration for the Mautic site:\n\nlocation ~ /\\.env {\n    deny all;\n}\n\n\n\n\n\nAfter modifying your Nginx configuration, remember to reload or restart your Nginx service for the changes to take effect."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-180",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-180 Exploiting Incorrectly Configured Access Control Security Levels"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "LOW",
                        "baseScore": 5.1,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-312",
                            "description": "CWE-312 Cleartext Storage of Sensitive Information",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "4e531c38-7a33-45d3-98dd-d909c0d8852e",
                "shortName": "Mautic",
                "dateUpdated": "2025-05-28T16:24:57.162Z"
            },
            "references": [
                {
                    "url": "https://github.com/mautic/mautic/security/advisories/GHSA-h2wg-v8wg-jhxh"
                }
            ],
            "source": {
                "advisory": "GHSA-h2wg-v8wg-jhxh",
                "discovery": "EXTERNAL"
            },
            "title": "Mautic does not shield .env files from web traffic",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}