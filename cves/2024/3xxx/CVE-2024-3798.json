{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-3798",
        "assignerOrgId": "4bb8329e-dd38-46c1-aafb-9bf32bcb93c6",
        "state": "PUBLISHED",
        "assignerShortName": "CERT-PL",
        "dateReserved": "2024-04-15T10:51:28.994Z",
        "datePublished": "2024-07-10T11:59:10.637Z",
        "dateUpdated": "2024-08-01T20:20:01.949Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unknown",
                    "product": "Phoniebox",
                    "programFiles": [
                        "htdocs/api/playlist/playsinglefile.php"
                    ],
                    "repo": "https://github.com/MiczFlor/RPi-Jukebox-RFID",
                    "vendor": "Phoniebox",
                    "versions": [
                        {
                            "lessThanOrEqual": "2.7",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "version": "3.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "datePublic": "2024-04-15T11:55:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p><span style=\"background-color: rgb(255, 255, 255);\">Insecure handling of GET header parameter <i>file</i>&nbsp;included in requests being sent to an instance of the</span><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;o</span><span style=\"background-color: var(--wht);\">pen-source project&nbsp;</span><span style=\"background-color: var(--wht);\">Phoniebox allows an attacker to create a website, which – when visited by a user – will send <span style=\"background-color: rgb(255, 255, 255);\">malicious&nbsp;</span>requests to multiple hosts on the local network. If such a request reaches the server, it will cause one of the following (<span style=\"background-color: rgb(255, 255, 255);\">depending on the chosen payload)</span>: shell command execution, reflected XSS or cross-site request forgery.<br></span></p><p>This issue affects Phoniebox in all releases through 2.7. Newer 2.x releases were not tested, but they might also be vulnerable.&nbsp;<br>Phoniebox in version 3.0 and higher are not affected.&nbsp;</p>"
                        }
                    ],
                    "value": "Insecure handling of GET header parameter file included in requests being sent to an instance of the open-source project Phoniebox allows an attacker to create a website, which – when visited by a user – will send malicious requests to multiple hosts on the local network. If such a request reaches the server, it will cause one of the following (depending on the chosen payload): shell command execution, reflected XSS or cross-site request forgery.\n\n\nThis issue affects Phoniebox in all releases through 2.7. Newer 2.x releases were not tested, but they might also be vulnerable. \nPhoniebox in version 3.0 and higher are not affected."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-62",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-62 Cross Site Request Forgery"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-591",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-591 Reflected XSS"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-88",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-88 OS Command Injection"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "LOW",
                        "attackRequirements": "NONE",
                        "attackVector": "NETWORK",
                        "baseScore": 8.7,
                        "baseSeverity": "HIGH",
                        "privilegesRequired": "NONE",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "LOW",
                        "subConfidentialityImpact": "LOW",
                        "subIntegrityImpact": "LOW",
                        "userInteraction": "PASSIVE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "HIGH",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-352",
                            "description": "CWE-352 Cross-Site Request Forgery (CSRF)",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-79",
                            "description": "CWE-79 Improper Neutralization of Input During Web Page Generation (XSS or 'Cross-site Scripting')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-78",
                            "description": "CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "4bb8329e-dd38-46c1-aafb-9bf32bcb93c6",
                "shortName": "CERT-PL",
                "dateUpdated": "2024-07-12T09:25:17.347Z"
            },
            "references": [
                {
                    "tags": [
                        "third-party-advisory"
                    ],
                    "url": "https://cert.pl/en/posts/2024/07/CVE-2024-3798"
                },
                {
                    "tags": [
                        "third-party-advisory"
                    ],
                    "url": "https://cert.pl/posts/2024/07/CVE-2024-3798"
                },
                {
                    "tags": [
                        "issue-tracking"
                    ],
                    "url": "https://github.com/MiczFlor/RPi-Jukebox-RFID/issues/2342"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "tags": [
                "x_open-source"
            ],
            "title": "Insecure handling of GET argument in Phoniebox",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        },
        "adp": [
            {
                "affected": [
                    {
                        "vendor": "sourcefabric",
                        "product": "phoniebox",
                        "cpes": [
                            "cpe:2.3:a:sourcefabric:phoniebox:*:*:*:*:*:*:*:*"
                        ],
                        "defaultStatus": "unknown",
                        "versions": [
                            {
                                "version": "0",
                                "status": "affected",
                                "lessThanOrEqual": "2.7",
                                "versionType": "custom"
                            }
                        ]
                    }
                ],
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-07-10T14:46:26.554633Z",
                                "id": "CVE-2024-3798",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "yes"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-07-10T14:46:29.447Z"
                }
            },
            {
                "providerMetadata": {
                    "orgId": "af854a3a-2127-422b-91ae-364da2661108",
                    "shortName": "CVE",
                    "dateUpdated": "2024-08-01T20:20:01.949Z"
                },
                "title": "CVE Program Container",
                "references": [
                    {
                        "tags": [
                            "third-party-advisory",
                            "x_transferred"
                        ],
                        "url": "https://cert.pl/en/posts/2024/07/CVE-2024-3798"
                    },
                    {
                        "tags": [
                            "third-party-advisory",
                            "x_transferred"
                        ],
                        "url": "https://cert.pl/posts/2024/07/CVE-2024-3798"
                    },
                    {
                        "tags": [
                            "issue-tracking",
                            "x_transferred"
                        ],
                        "url": "https://github.com/MiczFlor/RPi-Jukebox-RFID/issues/2342"
                    }
                ]
            }
        ]
    }
}