{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-53140",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-11-19T17:17:24.997Z",
        "datePublished": "2024-12-04T14:20:44.914Z",
        "dateUpdated": "2024-12-19T09:40:09.982Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-12-19T09:40:09.982Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetlink: terminate outstanding dump on socket close\n\nNetlink supports iterative dumping of data. It provides the families\nthe following ops:\n - start - (optional) kicks off the dumping process\n - dump  - actual dump helper, keeps getting called until it returns 0\n - done  - (optional) pairs with .start, can be used for cleanup\nThe whole process is asynchronous and the repeated calls to .dump\ndon't actually happen in a tight loop, but rather are triggered\nin response to recvmsg() on the socket.\n\nThis gives the user full control over the dump, but also means that\nthe user can close the socket without getting to the end of the dump.\nTo make sure .start is always paired with .done we check if there\nis an ongoing dump before freeing the socket, and if so call .done.\n\nThe complication is that sockets can get freed from BH and .done\nis allowed to sleep. So we use a workqueue to defer the call, when\nneeded.\n\nUnfortunately this does not work correctly. What we defer is not\nthe cleanup but rather releasing a reference on the socket.\nWe have no guarantee that we own the last reference, if someone\nelse holds the socket they may release it in BH and we're back\nto square one.\n\nThe whole dance, however, appears to be unnecessary. Only the user\ncan interact with dumps, so we can clean up when socket is closed.\nAnd close always happens in process context. Some async code may\nstill access the socket after close, queue notification skbs to it etc.\nbut no dumps can start, end or otherwise make progress.\n\nDelete the workqueue and flush the dump state directly from the release\nhandler. Note that further cleanup is possible in -next, for instance\nwe now always call .done before releasing the main module reference,\nso dump doesn't have to take a reference of its own."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/netlink/af_netlink.c",
                        "net/netlink/af_netlink.h"
                    ],
                    "versions": [
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "114a61d8d94ae3a43b82446cf737fd757021b834",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "598c956b62699c3753929602560d8df322e60559",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "6e3f2c512d2b7dbd247485b1dd9e43e4210a18f4",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "d2fab3d66cc16cfb9e3ea1772abe6b79b71fa603",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "4e87a52133284afbd40fb522dbf96e258af52a98",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "bbc769d2fa1b8b368c5fbe013b5b096afa3c05ca",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "176c41b3ca9281a9736b67c6121b03dbf0c8c08f",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "ed5d7788a934a4b6d6d025e948ed4da496b4f12e",
                            "lessThan": "1904fb9ebf911441f90a68e96b22aa73e4410505",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "net/netlink/af_netlink.c",
                        "net/netlink/af_netlink.h"
                    ],
                    "versions": [
                        {
                            "version": "4.9",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.9",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.19.325",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.287",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.231",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.174",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.119",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.6.63",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.11.10",
                            "lessThanOrEqual": "6.11.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/114a61d8d94ae3a43b82446cf737fd757021b834"
                },
                {
                    "url": "https://git.kernel.org/stable/c/598c956b62699c3753929602560d8df322e60559"
                },
                {
                    "url": "https://git.kernel.org/stable/c/6e3f2c512d2b7dbd247485b1dd9e43e4210a18f4"
                },
                {
                    "url": "https://git.kernel.org/stable/c/d2fab3d66cc16cfb9e3ea1772abe6b79b71fa603"
                },
                {
                    "url": "https://git.kernel.org/stable/c/4e87a52133284afbd40fb522dbf96e258af52a98"
                },
                {
                    "url": "https://git.kernel.org/stable/c/bbc769d2fa1b8b368c5fbe013b5b096afa3c05ca"
                },
                {
                    "url": "https://git.kernel.org/stable/c/176c41b3ca9281a9736b67c6121b03dbf0c8c08f"
                },
                {
                    "url": "https://git.kernel.org/stable/c/1904fb9ebf911441f90a68e96b22aa73e4410505"
                }
            ],
            "title": "netlink: terminate outstanding dump on socket close",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}