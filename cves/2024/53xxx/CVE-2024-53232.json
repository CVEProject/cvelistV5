{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-53232",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-11-19T17:17:25.025Z",
        "datePublished": "2024-12-27T13:50:19.551Z",
        "dateUpdated": "2025-01-20T06:21:44.033Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-01-20T06:21:44.033Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/s390: Implement blocking domain\n\nThis fixes a crash when surprise hot-unplugging a PCI device. This crash\nhappens because during hot-unplug __iommu_group_set_domain_nofail()\nattaching the default domain fails when the platform no longer\nrecognizes the device as it has already been removed and we end up with\na NULL domain pointer and UAF. This is exactly the case referred to in\nthe second comment in __iommu_device_set_domain() and just as stated\nthere if we can instead attach the blocking domain the UAF is prevented\nas this can handle the already removed device. Implement the blocking\ndomain to use this handling.  With this change, the crash is fixed but\nwe still hit a warning attempting to change DMA ownership on a blocked\ndevice."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/s390/include/asm/pci.h",
                        "arch/s390/pci/pci.c",
                        "arch/s390/pci/pci_debug.c",
                        "drivers/iommu/s390-iommu.c"
                    ],
                    "versions": [
                        {
                            "version": "c76c067e488ccd55734c3e750799caf2c5956db6",
                            "lessThan": "3be34fa1cdbf180c1a948cfededfdf2cdc497199",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "c76c067e488ccd55734c3e750799caf2c5956db6",
                            "lessThan": "bd89d94f3ea6fdaee983cbc69226a00b9bde6d59",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "c76c067e488ccd55734c3e750799caf2c5956db6",
                            "lessThan": "ecda483339a5151e3ca30d6b82691ef6f1d17912",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/s390/include/asm/pci.h",
                        "arch/s390/pci/pci.c",
                        "arch/s390/pci/pci_debug.c",
                        "drivers/iommu/s390-iommu.c"
                    ],
                    "versions": [
                        {
                            "version": "6.7",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "6.7",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.11.11",
                            "lessThanOrEqual": "6.11.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.12.2",
                            "lessThanOrEqual": "6.12.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.13",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/3be34fa1cdbf180c1a948cfededfdf2cdc497199"
                },
                {
                    "url": "https://git.kernel.org/stable/c/bd89d94f3ea6fdaee983cbc69226a00b9bde6d59"
                },
                {
                    "url": "https://git.kernel.org/stable/c/ecda483339a5151e3ca30d6b82691ef6f1d17912"
                }
            ],
            "title": "iommu/s390: Implement blocking domain",
            "x_generator": {
                "engine": "bippy-5f407fcff5a0"
            }
        }
    }
}