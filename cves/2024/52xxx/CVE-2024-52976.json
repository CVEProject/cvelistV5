{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-52976",
        "assignerOrgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
        "state": "PUBLISHED",
        "assignerShortName": "elastic",
        "dateReserved": "2024-11-18T14:48:22.150Z",
        "datePublished": "2025-05-01T13:03:58.672Z",
        "dateUpdated": "2025-05-01T13:03:58.672Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Elastic Agent",
                    "vendor": "Elastic",
                    "versions": [
                        {
                            "lessThanOrEqual": "7.17.24",
                            "status": "affected",
                            "version": "7.0.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThanOrEqual": "8.15.3",
                            "status": "affected",
                            "version": "8.0.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>Inclusion of functionality from an untrusted control sphere in Elastic Agent subprocess, osqueryd, allows local attackers to execute arbitrary code via parameter injection.</p><p>An attacker requires local access and the ability to modify osqueryd configurations.</p>"
                        }
                    ],
                    "value": "Inclusion of functionality from an untrusted control sphere in Elastic Agent subprocess, osqueryd, allows local attackers to execute arbitrary code via parameter injection.\n\nAn attacker requires local access and the ability to modify osqueryd configurations."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-242",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-242 Code Injection"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "NONE",
                        "baseScore": 4.4,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "HIGH",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-829",
                            "description": "CWE-829 Inclusion of Functionality from Untrusted Control Sphere",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
                "shortName": "elastic",
                "dateUpdated": "2025-05-01T13:03:58.672Z"
            },
            "references": [
                {
                    "url": "https://discuss.elastic.co/t/elastic-agent-7-17-25-and-8-15-4-security-update-esa-2024-39/377708"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Elastic Agent Inclusion of Functionality from Untrusted Control Sphere",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}