{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-29069",
        "assignerOrgId": "cc1ad9ee-3454-478d-9317-d3e869d708bc",
        "state": "PUBLISHED",
        "assignerShortName": "canonical",
        "dateReserved": "2024-03-14T23:09:12.771Z",
        "datePublished": "2024-07-25T19:39:41.050Z",
        "dateUpdated": "2024-07-25T19:39:41.050Z"
    },
    "containers": {
        "cna": {
            "title": "snapd will follow archived symlinks when unpacking a filesystem",
            "datePublic": "2024-03-14T13:47:00.000Z",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "lang": "en",
                            "cweId": "CWE-610",
                            "description": "CWE-610 Externally Controlled Reference to a Resource in Another Sphere",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-132",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-132 Symlink Attack"
                        }
                    ]
                }
            ],
            "affected": [
                {
                    "vendor": "Canonical",
                    "product": "snapd",
                    "platforms": [
                        "Linux"
                    ],
                    "packageName": "snapd",
                    "repo": "https://github.com/snapcore/snapd/",
                    "modules": [
                        "squashfs"
                    ],
                    "programFiles": [
                        "snap/container.go",
                        "snap/snapdir/snapdir.go",
                        "snap/squashfs/squashfs.go"
                    ],
                    "versions": [
                        {
                            "status": "affected",
                            "version": "0",
                            "lessThan": "2.62",
                            "versionType": "custom"
                        }
                    ],
                    "defaultStatus": "unaffected"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In snapd versions prior to 2.62, snapd failed to properly check the\ndestination of symbolic links when extracting a snap. The snap format \nis a squashfs file-system image and so can contain symbolic links and\nother file types. Various file entries within the snap squashfs image\n(such as icons and desktop files etc) are directly read by snapd when\nit is extracted. An attacker who could convince a user to install a\nmalicious snap which contained symbolic links at these paths could then \ncause snapd to write out the contents of the symbolic link destination\ninto a world-readable directory. This in-turn could allow an unprivileged\nuser to gain access to privileged information."
                }
            ],
            "references": [
                {
                    "url": "https://github.com/snapcore/snapd/pull/13682"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "Zeyad Gouda",
                    "type": "finder"
                }
            ],
            "metrics": [
                {
                    "format": "CVSS",
                    "cvssV3_1": {
                        "version": "3.1",
                        "attackVector": "LOCAL",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "REQUIRED",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "availabilityImpact": "LOW",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
                        "baseScore": 4.8,
                        "baseSeverity": "MEDIUM"
                    }
                }
            ],
            "providerMetadata": {
                "orgId": "cc1ad9ee-3454-478d-9317-d3e869d708bc",
                "shortName": "canonical",
                "dateUpdated": "2024-07-25T19:39:41.050Z"
            }
        }
    }
}