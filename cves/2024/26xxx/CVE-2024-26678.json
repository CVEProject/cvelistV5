{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-26678",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-02-19T14:20:24.152Z",
        "datePublished": "2024-04-02T07:01:42.262Z",
        "dateUpdated": "2024-05-29T05:20:41.121Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-05-29T05:20:41.121Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/efistub: Use 1:1 file:memory mapping for PE/COFF .compat section\n\nThe .compat section is a dummy PE section that contains the address of\nthe 32-bit entrypoint of the 64-bit kernel image if it is bootable from\n32-bit firmware (i.e., CONFIG_EFI_MIXED=y)\n\nThis section is only 8 bytes in size and is only referenced from the\nloader, and so it is placed at the end of the memory view of the image,\nto avoid the need for padding it to 4k, which is required for sections\nappearing in the middle of the image.\n\nUnfortunately, this violates the PE/COFF spec, and even if most EFI\nloaders will work correctly (including the Tianocore reference\nimplementation), PE loaders do exist that reject such images, on the\nbasis that both the file and memory views of the file contents should be\ndescribed by the section headers in a monotonically increasing manner\nwithout leaving any gaps.\n\nSo reorganize the sections to avoid this issue. This results in a slight\npadding overhead (< 4k) which can be avoided if desired by disabling\nCONFIG_EFI_MIXED (which is only needed in rare cases these days)"
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/boot/header.S",
                        "arch/x86/boot/setup.ld"
                    ],
                    "versions": [
                        {
                            "version": "c4421279b6c2",
                            "lessThan": "d327e961573f",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "686b58ce5052",
                            "lessThan": "0a962f2fbaa9",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "3e3eabe26dc8",
                            "lessThan": "4adeeff8c123",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "3e3eabe26dc8",
                            "lessThan": "1ad55cecf22f",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/boot/header.S",
                        "arch/x86/boot/setup.ld"
                    ],
                    "versions": [
                        {
                            "version": "6.7",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "6.7",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.7.5",
                            "lessThanOrEqual": "6.7.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.8",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/d327e961573fc335af0ae8a160302205327e1f4e"
                },
                {
                    "url": "https://git.kernel.org/stable/c/0a962f2fbaa976af9eed21d0306370cded485787"
                },
                {
                    "url": "https://git.kernel.org/stable/c/4adeeff8c12321cd453412a659c3c0eeb9bb2397"
                },
                {
                    "url": "https://git.kernel.org/stable/c/1ad55cecf22f05f1c884adf63cc09d3c3e609ebf"
                }
            ],
            "title": "x86/efistub: Use 1:1 file:memory mapping for PE/COFF .compat section",
            "x_generator": {
                "engine": "bippy-a5840b7849dd"
            }
        }
    }
}