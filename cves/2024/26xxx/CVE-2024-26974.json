{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-26974",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2024-02-19T14:20:24.203Z",
        "datePublished": "2024-05-01T05:20:14.163Z",
        "dateUpdated": "2024-05-29T05:26:12.530Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2024-05-29T05:26:12.530Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: qat - resolve race condition during AER recovery\n\nDuring the PCI AER system's error recovery process, the kernel driver\nmay encounter a race condition with freeing the reset_data structure's\nmemory. If the device restart will take more than 10 seconds the function\nscheduling that restart will exit due to a timeout, and the reset_data\nstructure will be freed. However, this data structure is used for\ncompletion notification after the restart is completed, which leads\nto a UAF bug.\n\nThis results in a KFENCE bug notice.\n\n  BUG: KFENCE: use-after-free read in adf_device_reset_worker+0x38/0xa0 [intel_qat]\n  Use-after-free read at 0x00000000bc56fddf (in kfence-#142):\n  adf_device_reset_worker+0x38/0xa0 [intel_qat]\n  process_one_work+0x173/0x340\n\nTo resolve this race condition, the memory associated to the container\nof the work_struct is freed on the worker if the timeout expired,\notherwise on the function that schedules the worker.\nThe timeout detection can be done by checking if the caller is\nstill waiting for completion or not by using completion_done() function."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/crypto/intel/qat/qat_common/adf_aer.c"
                    ],
                    "versions": [
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "daba62d9eedd",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "8e81cd58aee1",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "d03092550f52",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "4ae5a97781ce",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "226fc408c5fc",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "8a5a7611ccc7",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "0c2cf5142bfb",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "bb279ead4226",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "d8cba25d2c68",
                            "lessThan": "7d42e097607c",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/crypto/intel/qat/qat_common/adf_aer.c"
                    ],
                    "versions": [
                        {
                            "version": "3.17",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "3.17",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "4.19.312",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.4.274",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.10.215",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "5.15.154",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.1.84",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.6.24",
                            "lessThanOrEqual": "6.6.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.7.12",
                            "lessThanOrEqual": "6.7.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.8.3",
                            "lessThanOrEqual": "6.8.*",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "6.9",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/daba62d9eeddcc5b1081be7d348ca836c83c59d7"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8e81cd58aee14a470891733181a47d123193ba81"
                },
                {
                    "url": "https://git.kernel.org/stable/c/d03092550f526a79cf1ade7f0dfa74906f39eb71"
                },
                {
                    "url": "https://git.kernel.org/stable/c/4ae5a97781ce7d6ecc9c7055396535815b64ca4f"
                },
                {
                    "url": "https://git.kernel.org/stable/c/226fc408c5fcd23cc4186f05ea3a09a7a9aef2f7"
                },
                {
                    "url": "https://git.kernel.org/stable/c/8a5a7611ccc7b1fba8d933a9f22a2e76859d94dc"
                },
                {
                    "url": "https://git.kernel.org/stable/c/0c2cf5142bfb634c0ef0a1a69cdf37950747d0be"
                },
                {
                    "url": "https://git.kernel.org/stable/c/bb279ead42263e9fb09480f02a4247b2c287d828"
                },
                {
                    "url": "https://git.kernel.org/stable/c/7d42e097607c4d246d99225bf2b195b6167a210c"
                }
            ],
            "title": "crypto: qat - resolve race condition during AER recovery",
            "x_generator": {
                "engine": "bippy-a5840b7849dd"
            }
        }
    }
}