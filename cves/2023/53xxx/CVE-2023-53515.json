{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2023-53515",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-10-01T11:39:39.406Z",
        "datePublished": "2025-10-01T11:46:03.192Z",
        "dateUpdated": "2025-10-01T11:46:03.192Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-10-01T11:46:03.192Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio-mmio: don't break lifecycle of vm_dev\n\nvm_dev has a separate lifecycle because it has a 'struct device'\nembedded. Thus, having a release callback for it is correct.\n\nAllocating the vm_dev struct with devres totally breaks this protection,\nthough. Instead of waiting for the vm_dev release callback, the memory\nis freed when the platform_device is removed. Resulting in a\nuse-after-free when finally the callback is to be called.\n\nTo easily see the problem, compile the kernel with\nCONFIG_DEBUG_KOBJECT_RELEASE and unbind with sysfs.\n\nThe fix is easy, don't use devres in this case.\n\nFound during my research about object lifetime problems."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/virtio/virtio_mmio.c"
                    ],
                    "versions": [
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "97a2d55ead76358245b446efd87818e919196d7a",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "b788ad3b2468512339c05f23692e36860264e674",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "3ff54d904fafabd0912796785e53cce4e69ca123",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "5b7d5c2dd664eb8b9a06ecbc06e28d39359c422e",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "af5818c35173e096085c6ae2e3aac605d3d15e41",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "2dcb368fe5a8eee498ca75c93a18ce2f3b0d6a8e",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "7eb781b1bbb7136fe78fb8c28c1c223c61fa32b5",
                            "lessThan": "55c91fedd03d7b9cf0c5199b2eb12b9b8e95281a",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "drivers/virtio/virtio_mmio.c"
                    ],
                    "versions": [
                        {
                            "version": "4.15",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "4.15",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "4.19.293",
                            "lessThanOrEqual": "4.19.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.4.255",
                            "lessThanOrEqual": "5.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.10.192",
                            "lessThanOrEqual": "5.10.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "5.15.128",
                            "lessThanOrEqual": "5.15.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.1.47",
                            "lessThanOrEqual": "6.1.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.4.12",
                            "lessThanOrEqual": "6.4.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.5",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "cpeApplicability": [
                {
                    "nodes": [
                        {
                            "operator": "OR",
                            "negate": false,
                            "cpeMatch": [
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "4.19.293"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "5.4.255"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "5.10.192"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "5.15.128"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "6.1.47"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "6.4.12"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "4.15",
                                    "versionEndExcluding": "6.5"
                                }
                            ]
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/97a2d55ead76358245b446efd87818e919196d7a"
                },
                {
                    "url": "https://git.kernel.org/stable/c/b788ad3b2468512339c05f23692e36860264e674"
                },
                {
                    "url": "https://git.kernel.org/stable/c/3ff54d904fafabd0912796785e53cce4e69ca123"
                },
                {
                    "url": "https://git.kernel.org/stable/c/5b7d5c2dd664eb8b9a06ecbc06e28d39359c422e"
                },
                {
                    "url": "https://git.kernel.org/stable/c/af5818c35173e096085c6ae2e3aac605d3d15e41"
                },
                {
                    "url": "https://git.kernel.org/stable/c/2dcb368fe5a8eee498ca75c93a18ce2f3b0d6a8e"
                },
                {
                    "url": "https://git.kernel.org/stable/c/55c91fedd03d7b9cf0c5199b2eb12b9b8e95281a"
                }
            ],
            "title": "virtio-mmio: don't break lifecycle of vm_dev",
            "x_generator": {
                "engine": "bippy-1.2.0"
            }
        }
    }
}