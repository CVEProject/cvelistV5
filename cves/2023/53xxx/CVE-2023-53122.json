{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2023-53122",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-05-02T15:51:43.555Z",
        "datePublished": "2025-05-02T15:55:58.795Z",
        "dateUpdated": "2025-05-04T07:50:18.604Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-05-04T07:50:18.604Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nRISC-V: fix taking the text_mutex twice during sifive errata patching\n\nChris pointed out that some bonehead, *cough* me *cough*, added two\nmutex_locks() to the SiFive errata patching. The second was meant to\nhave been a mutex_unlock().\n\nThis results in errors such as\n\nUnable to handle kernel NULL pointer dereference at virtual address 0000000000000030\nOops [#1]\nModules linked in:\nCPU: 0 PID: 0 Comm: swapper Not tainted\n6.2.0-rc1-starlight-00079-g9493e6f3ce02 #229\nHardware name: BeagleV Starlight Beta (DT)\nepc : __schedule+0x42/0x500\n ra : schedule+0x46/0xce\nepc : ffffffff8065957c ra : ffffffff80659a80 sp : ffffffff81203c80\n gp : ffffffff812d50a0 tp : ffffffff8120db40 t0 : ffffffff81203d68\n t1 : 0000000000000001 t2 : 4c45203a76637369 s0 : ffffffff81203cf0\n s1 : ffffffff8120db40 a0 : 0000000000000000 a1 : ffffffff81213958\n a2 : ffffffff81213958 a3 : 0000000000000000 a4 : 0000000000000000\n a5 : ffffffff80a1bd00 a6 : 0000000000000000 a7 : 0000000052464e43\n s2 : ffffffff8120db41 s3 : ffffffff80a1ad00 s4 : 0000000000000000\n s5 : 0000000000000002 s6 : ffffffff81213938 s7 : 0000000000000000\n s8 : 0000000000000000 s9 : 0000000000000001 s10: ffffffff812d7204\n s11: ffffffff80d3c920 t3 : 0000000000000001 t4 : ffffffff812e6dd7\n t5 : ffffffff812e6dd8 t6 : ffffffff81203bb8\nstatus: 0000000200000100 badaddr: 0000000000000030 cause: 000000000000000d\n[<ffffffff80659a80>] schedule+0x46/0xce\n[<ffffffff80659dce>] schedule_preempt_disabled+0x16/0x28\n[<ffffffff8065ae0c>] __mutex_lock.constprop.0+0x3fe/0x652\n[<ffffffff8065b138>] __mutex_lock_slowpath+0xe/0x16\n[<ffffffff8065b182>] mutex_lock+0x42/0x4c\n[<ffffffff8000ad94>] sifive_errata_patch_func+0xf6/0x18c\n[<ffffffff80002b92>] _apply_alternatives+0x74/0x76\n[<ffffffff80802ee8>] apply_boot_alternatives+0x3c/0xfa\n[<ffffffff80803cb0>] setup_arch+0x60c/0x640\n[<ffffffff80800926>] start_kernel+0x8e/0x99c\n---[ end trace 0000000000000000 ]---\n\n[Palmer: pick up Geert's bug report from the thread]"
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/riscv/errata/sifive/errata.c"
                    ],
                    "versions": [
                        {
                            "version": "0fad198fffdabdeb07f6471f3311a246a9b35e7c",
                            "lessThan": "2feac714c6818f7767cfc21a3c10fa926b7398a3",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "f4fda52262d803bbaf554296d281d593dc4bf707",
                            "lessThan": "96a1600461957731b6d8ff3563c9f94b315bdaa1",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "9493e6f3ce02f44c21aa19f3cbf3b9aa05479d06",
                            "lessThan": "bf89b7ee52af5a5944fa3539e86089f72475055b",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/riscv/errata/sifive/errata.c"
                    ]
                }
            ],
            "cpeApplicability": [
                {
                    "nodes": [
                        {
                            "operator": "OR",
                            "negate": false,
                            "cpeMatch": []
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/2feac714c6818f7767cfc21a3c10fa926b7398a3"
                },
                {
                    "url": "https://git.kernel.org/stable/c/96a1600461957731b6d8ff3563c9f94b315bdaa1"
                },
                {
                    "url": "https://git.kernel.org/stable/c/bf89b7ee52af5a5944fa3539e86089f72475055b"
                }
            ],
            "title": "RISC-V: fix taking the text_mutex twice during sifive errata patching",
            "x_generator": {
                "engine": "bippy-1.2.0"
            }
        }
    }
}