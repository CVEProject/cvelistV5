{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2023-22404",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "dateUpdated": "2024-08-02T10:07:06.724Z",
        "dateReserved": "2022-12-27T00:00:00",
        "datePublished": "2023-01-12T00:00:00"
    },
    "containers": {
        "cna": {
            "title": "Junos OS: SRX Series and MX Series with SPC3: When IPsec VPN is configured iked will core when a specifically formatted payload is received",
            "datePublic": "2023-01-11T00:00:00",
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2023-01-12T00:00:00"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "An Out-of-bounds Write vulnerability in the Internet Key Exchange Protocol daemon (iked) of Juniper Networks Junos OS on SRX series and MX with SPC3 allows an authenticated, network-based attacker to cause a Denial of Service (DoS). iked will crash and restart, and the tunnel will not come up when a peer sends a specifically formatted payload during the negotiation. This will impact other IKE negotiations happening at the same time. Continued receipt of this specifically formatted payload will lead to continuous crashing of iked and thereby the inability for any IKE negotiations to take place. Note that this payload is only processed after the authentication has successfully completed. So the issue can only be exploited by an attacker who can successfully authenticate. This issue affects Juniper Networks Junos OS on SRX Series, and MX Series with SPC3: All versions prior to 19.3R3-S7; 19.4 versions prior to 19.4R3-S9; 20.2 versions prior to 20.2R3-S5; 20.3 versions prior to 20.3R3-S5; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3-S3; 21.2 versions prior to 21.2R3-S2; 21.3 versions prior to 21.3R3-S1; 21.4 versions prior to 21.4R2-S1, 21.4R3; 22.1 versions prior to 22.1R1-S2, 22.1R2."
                }
            ],
            "affected": [
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "19.3R3-S7",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "19.4",
                            "status": "affected",
                            "lessThan": "19.4R3-S9",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.2",
                            "status": "affected",
                            "lessThan": "20.2R3-S5",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.3",
                            "status": "affected",
                            "lessThan": "20.3R3-S5",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.4",
                            "status": "affected",
                            "lessThan": "20.4R3-S4",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.1",
                            "status": "affected",
                            "lessThan": "21.1R3-S3",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.2",
                            "status": "affected",
                            "lessThan": "21.2R3-S2",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3",
                            "status": "affected",
                            "lessThan": "21.3R3-S1",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.4",
                            "status": "affected",
                            "lessThan": "21.4R2-S1, 21.4R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.1",
                            "status": "affected",
                            "lessThan": "22.1R1-S2, 22.1R2",
                            "versionType": "custom"
                        }
                    ],
                    "platforms": [
                        "SRX Series MX Series with SPC3"
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://kb.juniper.net/JSA70200"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "HIGH",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-787 Out-of-bounds Write",
                            "cweId": "CWE-787"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "type": "text",
                            "lang": "en",
                            "description": "Denial of Service (DoS)"
                        }
                    ]
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "source": {
                "advisory": "JSA70200",
                "defect": [
                    "1665150"
                ],
                "discovery": "USER"
            },
            "configurations": [
                {
                    "lang": "en",
                    "value": "To be affected by this issue IPsec VPN configuration needs to present similar to the following example:\n\n  [ security ike proposal <ike-proposal> ... ]\n  [ security ike policy <ike-policy> ... ] \n  [ security ike gateway <gateway-name> ... ]\n  [ security ipsec proposal <ipsec-proposal> ... ]\n  [ security ipsec policy <ipsec-policy> ... ]\n  [ security ipsec vpn <vpn-name> ike gateway <gateway-name> ]\n  [ security ipsec vpn <vpn-name> ike ipsec-policy <ipsec-policy> ]\n  [ security ipsec vpn <vpn-name> bind-interface <interface> ]\n\nand the system needs to run iked (vs. kmd which is not affected), which can be verified with:\n\n  show system processes extensive | match \"KMD|IKED\""
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "There are no known workarounds for this issue."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue: 19.3R3-S7, 19.4R3-S9, 20.2R3-S5, 20.3R3-S5, 20.4R3-S4, 21.1R3-S3, 21.2R3-S2, 21.3R3-S1, 21.4R2-S1, 21.4R3, 22.1R1-S2, 22.1R2, 22.2R1, and all subsequent releases."
                }
            ]
        },
        "adp": [
            {
                "providerMetadata": {
                    "orgId": "af854a3a-2127-422b-91ae-364da2661108",
                    "shortName": "CVE",
                    "dateUpdated": "2024-08-02T10:07:06.724Z"
                },
                "title": "CVE Program Container",
                "references": [
                    {
                        "url": "https://kb.juniper.net/JSA70200",
                        "tags": [
                            "x_transferred"
                        ]
                    }
                ]
            }
        ]
    }
}